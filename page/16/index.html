<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-5653382914441020",
      enable_page_level_ads: true
    });
  </script>

  <meta name="google-site-verification" content="WSpJFvfcmIPBX_iK8uPbmCHIy_0f1lvd7ZJpbyad2sA">
  <meta name="yandex-verification" content="808eb057eb8396cc">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kezunlin.me","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Kezunlin&#39;s Blog">
<meta property="og:url" content="https://kezunlin.me/page/16/index.html">
<meta property="og:site_name" content="Kezunlin&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="kezunlin">
<meta property="article:tag" content="linux, c++, python, AI, LLM">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://kezunlin.me/page/16/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Kezunlin's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Kezunlin's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Kezunlin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Live and Learn</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/compile-glog-and-glags-on-ubuntu-16-04/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/compile-glog-and-glags-on-ubuntu-16-04/" class="post-title-link" itemprop="url">compile glog and glags on ubuntu 16.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-02-23 16:30:00" itemprop="dateCreated datePublished" datetime="2018-02-23T16:30:00+08:00">2018-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><ul>
<li><a href="https://kezunlin.me/post/bb64e398/">compile glog and glags on windows</a></li>
<li><strong><a href="https://kezunlin.me/post/977f5125/">compile glog and glags on ubuntu 16.04</a></strong></li>
</ul>
<h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="download-source"><a href="#download-source" class="headerlink" title="download source"></a>download source</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/schuhschuh/gflags/archive/v2.2.1.tar.gz</span><br><span class="line">wget https://github.com/google/glog/archive/v0.3.5.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="gflags"><a href="#gflags" class="headerlink" title="gflags"></a>gflags</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> gflags</span><br><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>

<p>with options </p>
<pre><code>BUILD_SHARED_LIBS ON 
INSTALL_SHARED_LIBS ON
INSTALL_STATIC_LIBS OFF
CMAKE_CONFIGURATION_TYPES Release
REGISTER_INSTALL_PREFIX OFF

#NAMESPACE google;gflags
NAMESPACE google
</code></pre>
<p>compile and install </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make -j8</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure>

<h4 id="gflags-config-cmake"><a href="#gflags-config-cmake" class="headerlink" title="gflags-config.cmake"></a>gflags-config.cmake</h4><p>comes from <code>caffe/cmake/Modules/FindGFlags.cmake</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - Try to find GFLAGS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The following variables are optionally searched for defaults</span></span><br><span class="line"><span class="comment">#  GFLAGS_ROOT_DIR:            Base directory where all GFLAGS components are found</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The following are set after configuration is done:</span></span><br><span class="line"><span class="comment">#  GFLAGS_FOUND</span></span><br><span class="line"><span class="comment">#  GFLAGS_INCLUDE_DIRS</span></span><br><span class="line"><span class="comment">#  GFLAGS_LIBRARIES</span></span><br><span class="line"><span class="comment">#  GFLAGS_LIBRARYRARY_DIRS</span></span><br><span class="line"></span><br><span class="line">include(FindPackageHandleStandardArgs)</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>(GFLAGS_ROOT_DIR <span class="string">&quot;&quot;</span> CACHE PATH <span class="string">&quot;Folder contains Gflags&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># We are testing only a couple of files in the include directories</span></span><br><span class="line"><span class="keyword">if</span>(WIN32)</span><br><span class="line">    find_path(GFLAGS_INCLUDE_DIR gflags/gflags.h</span><br><span class="line">        PATHS <span class="variable">$&#123;GFLAGS_ROOT_DIR&#125;</span>/src/windows)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    find_path(GFLAGS_INCLUDE_DIR gflags/gflags.h</span><br><span class="line">        PATHS <span class="variable">$&#123;GFLAGS_ROOT_DIR&#125;</span>)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(MSVC)</span><br><span class="line">    find_library(GFLAGS_LIBRARY_RELEASE</span><br><span class="line">        NAMES libgflags</span><br><span class="line">        PATHS <span class="variable">$&#123;GFLAGS_ROOT_DIR&#125;</span></span><br><span class="line">        PATH_SUFFIXES Release)</span><br><span class="line"></span><br><span class="line">    find_library(GFLAGS_LIBRARY_DEBUG</span><br><span class="line">        NAMES libgflags-debug</span><br><span class="line">        PATHS <span class="variable">$&#123;GFLAGS_ROOT_DIR&#125;</span></span><br><span class="line">        PATH_SUFFIXES Debug)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span>(GFLAGS_LIBRARY optimized <span class="variable">$&#123;GFLAGS_LIBRARY_RELEASE&#125;</span> debug <span class="variable">$&#123;GFLAGS_LIBRARY_DEBUG&#125;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    find_library(GFLAGS_LIBRARY gflags)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line">find_package_handle_standard_args(GFlags DEFAULT_MSG GFLAGS_INCLUDE_DIR GFLAGS_LIBRARY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(GFLAGS_FOUND)</span><br><span class="line">    <span class="built_in">set</span>(GFLAGS_INCLUDE_DIRS <span class="variable">$&#123;GFLAGS_INCLUDE_DIR&#125;</span>)</span><br><span class="line">    <span class="built_in">set</span>(GFLAGS_LIBRARIES <span class="variable">$&#123;GFLAGS_LIBRARY&#125;</span>)</span><br><span class="line">    message(STATUS <span class="string">&quot;Found gflags  (include: <span class="variable">$&#123;GFLAGS_INCLUDE_DIR&#125;</span>, library: <span class="variable">$&#123;GFLAGS_LIBRARY&#125;</span>)&quot;</span>)</span><br><span class="line">    mark_as_advanced(GFLAGS_LIBRARY_DEBUG GFLAGS_LIBRARY_RELEASE</span><br><span class="line">                     GFLAGS_LIBRARY GFLAGS_INCLUDE_DIR GFLAGS_ROOT_DIR)</span><br><span class="line">endif()</span><br></pre></td></tr></table></figure>

<p>copy <code>gflags-config.cmake</code> to <code>/usr/local/lib/cmake/gflags/</code></p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<h3 id="glog"><a href="#glog" class="headerlink" title="glog"></a>glog</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> glog</span><br><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>

<p>with options </p>
<pre><code>WITH_GFLAGS ON 
CMAKE_CONFIGURATION_TYPES Release

BUILD_SHARED_LIBS ON  # new by hand
</code></pre>
<p>compile and install </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make -j8</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure>

<h4 id="glog-config-cmake"><a href="#glog-config-cmake" class="headerlink" title="glog-config.cmake"></a>glog-config.cmake</h4><p>comes from <code>caffe/cmake/Modules/FindGFlags.cmake</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># - Try to find Glog</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The following variables are optionally searched for defaults</span></span><br><span class="line"><span class="comment">#  GLOG_ROOT_DIR:            Base directory where all GLOG components are found</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The following are set after configuration is done:</span></span><br><span class="line"><span class="comment">#  GLOG_FOUND</span></span><br><span class="line"><span class="comment">#  GLOG_INCLUDE_DIRS</span></span><br><span class="line"><span class="comment">#  GLOG_LIBRARIES</span></span><br><span class="line"><span class="comment">#  GLOG_LIBRARYRARY_DIRS</span></span><br><span class="line"></span><br><span class="line">include(FindPackageHandleStandardArgs)</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>(GLOG_ROOT_DIR <span class="string">&quot;&quot;</span> CACHE PATH <span class="string">&quot;Folder contains Google glog&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(WIN32)</span><br><span class="line">    find_path(GLOG_INCLUDE_DIR glog/logging.h</span><br><span class="line">        PATHS <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span>/src/windows)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    find_path(GLOG_INCLUDE_DIR glog/logging.h</span><br><span class="line">        PATHS <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span>)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(MSVC)</span><br><span class="line">    find_library(GLOG_LIBRARY_RELEASE libglog_static</span><br><span class="line">        PATHS <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span></span><br><span class="line">        PATH_SUFFIXES Release)</span><br><span class="line"></span><br><span class="line">    find_library(GLOG_LIBRARY_DEBUG libglog_static</span><br><span class="line">        PATHS <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span></span><br><span class="line">        PATH_SUFFIXES Debug)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span>(GLOG_LIBRARY optimized <span class="variable">$&#123;GLOG_LIBRARY_RELEASE&#125;</span> debug <span class="variable">$&#123;GLOG_LIBRARY_DEBUG&#125;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    find_library(GLOG_LIBRARY glog</span><br><span class="line">        PATHS <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span></span><br><span class="line">        PATH_SUFFIXES lib lib64)</span><br><span class="line">endif()</span><br><span class="line"></span><br><span class="line">find_package_handle_standard_args(Glog DEFAULT_MSG GLOG_INCLUDE_DIR GLOG_LIBRARY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(GLOG_FOUND)</span><br><span class="line">  <span class="built_in">set</span>(GLOG_INCLUDE_DIRS <span class="variable">$&#123;GLOG_INCLUDE_DIR&#125;</span>)</span><br><span class="line">  <span class="built_in">set</span>(GLOG_LIBRARIES <span class="variable">$&#123;GLOG_LIBRARY&#125;</span>)</span><br><span class="line">  message(STATUS <span class="string">&quot;Found glog    (include: <span class="variable">$&#123;GLOG_INCLUDE_DIR&#125;</span>, library: <span class="variable">$&#123;GLOG_LIBRARY&#125;</span>)&quot;</span>)</span><br><span class="line">  mark_as_advanced(GLOG_ROOT_DIR GLOG_LIBRARY_RELEASE GLOG_LIBRARY_DEBUG</span><br><span class="line">                                 GLOG_LIBRARY GLOG_INCLUDE_DIR)</span><br><span class="line">endif()</span><br></pre></td></tr></table></figure>

<p>copy <code>glog-config.cmake</code> to <code>/usr/local/lib/cmake/glog/</code></p>
<h2 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code"></a>Example Code</h2><h3 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 2.6)</span><br><span class="line"></span><br><span class="line">project(glog_proj)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Locate GTest</span></span><br><span class="line">find_package(GTest REQUIRED)</span><br><span class="line">include_directories(<span class="variable">$&#123;GTEST_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line">find_package(GFLAGS REQUIRED) </span><br><span class="line">include_directories(<span class="variable">$&#123;GFLAGS_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line">find_package(GLOG REQUIRED) </span><br><span class="line">include_directories(<span class="variable">$&#123;GLOG_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># for windows</span></span><br><span class="line"><span class="comment">#add_definitions( -DGLOG_NO_ABBREVIATED_SEVERITIES ) </span></span><br><span class="line"></span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; GFLAGS_FOUND = <span class="variable">$&#123;GFLAGS_FOUND&#125;</span>&quot;</span>)</span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; GFLAGS_INCLUDE_DIRS = <span class="variable">$&#123;GFLAGS_INCLUDE_DIRS&#125;</span>&quot;</span>)</span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; GFLAGS_LIBRARIES = <span class="variable">$&#123;GFLAGS_LIBRARIES&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; GLOG_FOUND = <span class="variable">$&#123;GLOG_FOUND&#125;</span>&quot;</span>)</span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; GLOG_INCLUDE_DIRS = <span class="variable">$&#123;GLOG_INCLUDE_DIRS&#125;</span>&quot;</span>)</span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; GLOG_LIBRARIES = <span class="variable">$&#123;GLOG_LIBRARIES&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">add_executable(demo glog_main.cpp)</span><br><span class="line">target_link_libraries (demo  <span class="variable">$&#123;GLOG_LIBRARIES&#125;</span> <span class="variable">$&#123;GFLAGS_LIBRARIES&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;gflags/gflags.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;glog/logging.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	FLAGS_logtostderr = true;  </span></span><br><span class="line"><span class="comment">	FLAGS_alsologtostderr = true;  </span></span><br><span class="line"><span class="comment">	FLAGS_colorlogtostderr = true;  </span></span><br><span class="line"><span class="comment">	FLAGS_log_prefix = true;  </span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	FLAGS_logbufsecs = 0;  //0 means realtime</span></span><br><span class="line"><span class="comment">	FLAGS_max_log_size = 10;  // MB</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	google::<span class="built_in">InitGoogleLogging</span>(argv[<span class="number">0</span>]); <span class="comment">// init google logging</span></span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_FATAL, <span class="string">&quot;../log/log_fatal_&quot;</span>); </span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_ERROR, <span class="string">&quot;../log/log_error_&quot;</span>); </span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_WARNING, <span class="string">&quot;../log/log_warning_&quot;</span>);</span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_INFO, <span class="string">&quot;../log/log_info_&quot;</span>); </span><br><span class="line"></span><br><span class="line">	<span class="built_in">LOG</span>(INFO) &lt;&lt; <span class="string">&quot;Hello GLOG&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://kezunlin.me/post/977f5125/">compile glog and glags on windows</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180223: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/guide-to-compile-and-install-poco-cpp-library-on-ubuntu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/guide-to-compile-and-install-poco-cpp-library-on-ubuntu/" class="post-title-link" itemprop="url">how to compile and install poco cpp library on ubuntu 16.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-02-22 17:08:00" itemprop="dateCreated datePublished" datetime="2018-02-22T17:08:00+08:00">2018-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><ul>
<li><a href="https://kezunlin.me/post/9587bb47/">how to compile and install poco cpp library on windows</a></li>
<li><strong><a href="https://kezunlin.me/post/281dd8cd/">how to compile and install poco cpp library on ubuntu 16.04</a></strong></li>
</ul>
<h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="apt-get"><a href="#apt-get" class="headerlink" title="apt-get"></a><del>apt-get</del></h3><blockquote>
<p>install by apt-get, but we can not use <code>find_package(Poco)</code> because no <code>/usr/local/lib/cmake/Poco/PocoConfig.cmake</code> installed.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install libpoco-doc libpoco-dev</span><br></pre></td></tr></table></figure>

<h3 id="compile-from-source"><a href="#compile-from-source" class="headerlink" title="compile from source"></a>compile from source</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">wget https://pocoproject.org/releases/poco-1.8.1/poco-1.8.1.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#Install dependences</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install openssl libssl-dev</span><br><span class="line"><span class="built_in">sudo</span> apt-get install libiodbc2 libiodbc2-dev</span><br><span class="line"><span class="built_in">sudo</span> apt-get install libmysqlclient-dev</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> poco-1.8.1</span><br><span class="line"><span class="comment">#sudo ./configure --omit=Data/ODBC,Data/MySQL --no-tests --no-samples --shared</span></span><br><span class="line"><span class="built_in">cd</span> build </span><br><span class="line">cmake-gui ..</span><br><span class="line"><span class="built_in">sudo</span> make -j8 </span><br><span class="line"><span class="built_in">sudo</span> make install </span><br></pre></td></tr></table></figure>

<p>OK. we install headers to <code>/usr/local/include/Poco</code> and libraries to <code>/usr/local/lib/</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> /usr/local/libPoco*.so </span><br><span class="line"></span><br><span class="line">/usr/local/lib/libPocoFoundation.so  /usr/local/lib/libPocoNet.so   /usr/local/lib/libPocoXML.so</span><br><span class="line">/usr/local/lib/libPocoJSON.so        /usr/local/lib/libPocoUtil.so</span><br></pre></td></tr></table></figure>

<p>we install cmake files to <code>/usr/local/lib/cmake/Poco</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> /usr/local/lib/cmake/Poco</span><br><span class="line"></span><br><span class="line">PocoConfig.cmake                     PocoJSONTargets.cmake          PocoUtilTargets.cmake</span><br><span class="line">PocoConfigVersion.cmake              PocoJSONTargets-release.cmake  PocoUtilTargets-release.cmake</span><br><span class="line">PocoFoundationConfig.cmake           PocoNetConfig.cmake            PocoXMLConfig.cmake</span><br><span class="line">PocoFoundationConfigVersion.cmake    PocoNetConfigVersion.cmake     PocoXMLConfigVersion.cmake</span><br><span class="line">PocoFoundationTargets.cmake          PocoNetTargets.cmake           PocoXMLTargets.cmake</span><br><span class="line">PocoFoundationTargets-release.cmake  PocoNetTargets-release.cmake   PocoXMLTargets-release.cmake</span><br><span class="line">PocoJSONConfig.cmake                 PocoUtilConfig.cmake</span><br><span class="line">PocoJSONConfigVersion.cmake          PocoUtilConfigVersion.cmake</span><br></pre></td></tr></table></figure>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><h3 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required (VERSION 2.6)</span><br><span class="line"></span><br><span class="line">project (event_demo)</span><br><span class="line">enable_language(C)</span><br><span class="line">enable_language(CXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Always include the source and build directories in the include path.</span></span><br><span class="line"><span class="built_in">set</span>(CMAKE_INCLUDE_CURRENT_DIR ON)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the output folder where your program will be created</span></span><br><span class="line"><span class="built_in">set</span>(CMAKE_BINARY_DIR <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"><span class="built_in">set</span>(EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>)</span><br><span class="line"><span class="built_in">set</span>(LIBRARY_OUTPUT_PATH <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find Poco package  1.8.1</span></span><br><span class="line">find_package(Poco REQUIRED COMPONENTS Foundation Util Net XML JSON)</span><br><span class="line"></span><br><span class="line"><span class="comment"># no Poco_INCLUDE_DIRS, we have to set by hand </span></span><br><span class="line"><span class="keyword">if</span>(MSVC) <span class="comment"># WIN32</span></span><br><span class="line">	SET(Poco_INCLUDE_DIRS <span class="string">&quot;C:/Program Files/Poco/include&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">	SET(Poco_INCLUDE_DIRS <span class="string">&quot;/usr/local/include/Poco&quot;</span>)</span><br><span class="line">endif(MSVC)</span><br><span class="line"></span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; Poco_INCLUDE_DIRS = <span class="variable">$&#123;Poco_INCLUDE_DIRS&#125;</span>&quot;</span>)</span><br><span class="line">MESSAGE( [Main] <span class="string">&quot; Poco_LIBRARIES = <span class="variable">$&#123;Poco_LIBRARIES&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The following folder will be included</span></span><br><span class="line">include_directories(</span><br><span class="line">    <span class="variable">$&#123;MY_SRC_INCLUDE&#125;</span>  </span><br><span class="line">    <span class="variable">$&#123;Poco_INCLUDE_DIRS&#125;</span> </span><br><span class="line">)   </span><br><span class="line"></span><br><span class="line">link_directories(<span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>) </span><br><span class="line"></span><br><span class="line">add_executable(event_demo event_demo.cpp)</span><br><span class="line">target_link_libraries(event_demo <span class="variable">$&#123;Poco_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lidabo/p/4062071.html">compile poco on ubuntu</a></li>
<li><a target="_blank" rel="noopener" href="https://yyangtech.wordpress.com/">install and compile poco on ubuntu</a></li>
<li><a target="_blank" rel="noopener" href="https://fedetft.wordpress.com/2010/03/07/cmake-part-3-finding-libraries/">find poco</a></li>
<li><a target="_blank" rel="noopener" href="http://svn.mitk.org/trunk/mitk/BlueBerry/CMake/FindPoco.cmake">FindPoco.cmake</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/16971349/cmake-cannot-find-custom-module">cmake-cannot-find-custom-module</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/pocoproject/poco/tree/develop/cmake">poco cmake</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180222: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/velodyne-veloview-and-velodynecapture-guide-on-windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/velodyne-veloview-and-velodynecapture-guide-on-windows/" class="post-title-link" itemprop="url">velodyne veloview and velodynecapture guide on windows and ubuntu 16.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-02-11 05:16:00" itemprop="dateCreated datePublished" datetime="2018-02-11T05:16:00+08:00">2018-02-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="install-VeloView"><a href="#install-VeloView" class="headerlink" title="install VeloView"></a>install VeloView</h3><p>download <a target="_blank" rel="noopener" href="https://www.paraview.org/paraview-downloads/download.php?submit=Download&version=v5.1&type=app&os=win64&downloadFile=VeloView-3.5.0-Windows-64bit.exe">VeloView</a> and install.</p>
<p>For “sensor streaming” (live display of sensor data) it is important to change the network settings of the <code>Ethernet adapter</code> connected to the sensor from <code>automatic IP address</code> to <code>manual IP address</code> selection and choose:</p>
<p>Notes from <a target="_blank" rel="noopener" href="https://github.com/Kitware/VeloView">VeloView github</a></p>
<ul>
<li><p>VLP-16 &#x2F;  HDL-32E<br>IP address: 192.168.1.77 (77 as example, any number except 201 works)<br>Gateway: 255.255.255.0</p>
</li>
<li><p>HDL-64E<br>IP address: 192.168.3.77 (77 as example, any number except 43 works)<br>Gateway: 192.168.3.255</p>
</li>
</ul>
<p>In order for sensor streaming to work properly, it is important to disable firewall restrictions for the Ethernet port. Disable the firewall completely for the ethernet device connected to the sensor or explicitly allow data from that Ethernet port of (including both public and private networks).</p>
<h3 id="config-guide"><a href="#config-guide" class="headerlink" title="config guide"></a>config guide</h3><p>Setting up your computer to communicate with the sensor</p>
<ul>
<li>Connect the computer to the interface box with an Ethernet Cable.</li>
<li>Apply power to the sensor.</li>
<li>For now, disable the WiFI connection on your computer.</li>
<li>Configure your computer’s IP address on its Ethernet port to manual mode.</li>
<li>Set your computer’s IP address to <code>192.168.1.77</code> (“77” can be any number except 0, 255, or 201)</li>
<li>Set the subnet mask to 255.255.255.0</li>
<li>Pull up the sensor’s webserver interface by typing the sensor’s network address, <code>192.168.1.201</code>, into the address bar in your web browser</li>
</ul>
<h3 id="steps"><a href="#steps" class="headerlink" title="steps"></a>steps</h3><h4 id="windows-ip-config"><a href="#windows-ip-config" class="headerlink" title="windows ip config"></a>windows ip config</h4><ol>
<li><p>set computer IP address on its Ethernet port to to manual mode with ip&#x3D;<code>192.168.1.77</code> (<code>77</code>  can be any number except <code>0,255,201</code>),gateway&#x3D;<code>192.168.1.1</code>,mask&#x3D;<code>255.255.255.0</code></p>
</li>
<li><p>check by ifconfig</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ ifconfig</span><br><span class="line">     </span><br><span class="line"> 以太网适配器 以太网:</span><br><span class="line"></span><br><span class="line">    连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line">    本地链接 IPv6 地址. . . . . . . . : fe80::9164:9f68:3c08:8493%17</span><br><span class="line">    IPv4 地址 . . . . . . . . . . . . : 192.168.1.77</span><br><span class="line">    子网掩码  . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">    默认网关. . . . . . . . . . . . . : 192.168.1.1</span><br><span class="line"></span><br><span class="line"> 无线局域网适配器 WLAN:</span><br><span class="line"></span><br><span class="line">    连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line">    本地链接 IPv6 地址. . . . . . . . : fe80::b13c:895a:8b08:5ec2%6</span><br><span class="line">    IPv4 地址 . . . . . . . . . . . . : 192.168.0.130</span><br><span class="line">    子网掩码  . . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">    默认网关. . . . . . . . . . . . . : 192.168.0.1</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="ubuntu-ip-config"><a href="#ubuntu-ip-config" class="headerlink" title="ubuntu ip config"></a>ubuntu ip config</h4><ol>
<li><p>set computer IP address on <code>eth0</code> with ip&#x3D;<code>192.168.1.77</code> (<code>77</code>  can be any number except <code>0,255,201</code>),gateway&#x3D;<code>192.168.1.1</code>,mask&#x3D;<code>255.255.255.0</code></p>
</li>
<li><p>edit network interfaces <code>/etc/network/interfaces</code></p>
   <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">auto eth0</span><br><span class="line">iface eth0 inet static</span><br><span class="line">address 192.168.1.77 </span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 192.168.1.1 </span><br></pre></td></tr></table></figure></li>
<li><p>reboot</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> reboot now</span><br></pre></td></tr></table></figure>
</li>
<li><p>check eth0</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> ifconfig</span><br><span class="line"></span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 80:fa:5b:47:92:8a  </span><br><span class="line">          inet addr:192.168.1.77  Bcast:192.168.1.255  Mask:255.255.255.0</span><br><span class="line">          UP BROADCAST MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:0 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1/128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:65536  Metric:1</span><br><span class="line">          RX packets:4640 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:4640 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:865530 (865.5 KB)  TX bytes:865530 (865.5 KB)</span><br><span class="line"></span><br><span class="line">wlan0     Link encap:Ethernet  HWaddr b0:35:9f:53:68:c6  </span><br><span class="line">          inet addr:192.168.0.130  Bcast:192.168.0.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::a3d7:e190:6fb3:133/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:6536 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:380 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:581427 (581.4 KB)  TX bytes:46439 (46.4 KB)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Establish communication with the webserver GUI with <code>Default IP: 192.168.1.201</code> on chrome.</p>
<ul>
<li><p>for windows:<br><img src="https://kezunlin.me/images/posts/635233-20180211140943654-31527519.png" alt="vlp16 web user interface for windows"></p>
</li>
<li><p>for ubuntu<br><img src="https://kezunlin.me/images/posts/635233-20180222154255105-313321611.png" alt="vlp16 web user interface for ubuntu"></p>
</li>
</ul>
</li>
</ol>
<blockquote>
<p>we use data port <code>2368</code> in program.</p>
</blockquote>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<ol start="6">
<li>View vlp16 by VeloView</li>
</ol>
<p>  <img src="https://kezunlin.me/images/posts/635233-20180211140949232-1677408378.png" alt="VeloView for vlp16"></p>
<h2 id="VelodyneCapture-Example"><a href="#VelodyneCapture-Example" class="headerlink" title="VelodyneCapture Example"></a>VelodyneCapture Example</h2><p>We can get <code>VelodyneCapture</code> class from <a target="_blank" rel="noopener" href="https://github.com/UnaNancyOwen/VelodyneCapture/blob/master/VelodyneCapture.h">VelodyneCapture.h</a></p>
<ul>
<li>HDLGrabber: This Grabber for HDL-64E&#x2F;HDL-32E.</li>
<li>VLPGrabber: This Grabber for VLP-16.</li>
</ul>
<blockquote>
<p>In this article using Velodyne grabber that has implemented in PCL.<br>It returns coordinated Point Cloud data. You don’t need to convert coordinates yourself.</p>
</blockquote>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.paraview.org/Wiki/VeloView">VeloView wiki</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Kitware/VeloView">VeloView github</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/zz2862625432/article/details/78112707">vlp16 configure</a></li>
<li><a target="_blank" rel="noopener" href="http://unanancyowen.com/en/pcl-with-velodyne/">pcl-with-velodyne</a></li>
<li><a target="_blank" rel="noopener" href="http://unanancyowen.com/en/capture-from-velodyne/">VelodyneCapture</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/UnaNancyOwen/VelodyneCapture">VelodyneCapture github</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/littlethunder/article/details/51920681">vlp16 usage</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/UnaNancyOwen/9f9459d3c10f7a6325ebebabda9865f7">pcl visualization for Velodyne VLP-16</a></li>
<li><a target="_blank" rel="noopener" href="http://unanancyowen.com/en/pcl_kinectv2_without_grabber/">pcl point cloud update&#x2F;add</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180211: created.</li>
<li>20180222: add ubuntu velodyne ip config.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/cmake-find-package-for-different-packages/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/cmake-find-package-for-different-packages/" class="post-title-link" itemprop="url">cmake find_package for different packages</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-02-08 06:46:00" itemprop="dateCreated datePublished" datetime="2018-02-08T06:46:00+08:00">2018-02-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Packages"><a href="#Packages" class="headerlink" title="Packages"></a>Packages</h2><h3 id="Boost"><a href="#Boost" class="headerlink" title="Boost"></a>Boost</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install libboost-all-dev</span><br></pre></td></tr></table></figure>

<p>CMakeLists.txt</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Boost</span></span><br><span class="line"><span class="keyword">if</span>(MSVC)</span><br><span class="line">	<span class="comment"># use static boost on windows</span></span><br><span class="line">	<span class="keyword">set</span>(Boost_USE_STATIC_LIBS <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">	<span class="comment"># use release boost on linux</span></span><br><span class="line">	<span class="keyword">set</span>(Boost_USE_RELEASE_LIBS <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">endif</span>(MSVC)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(Boost_USE_MULTITHREAD <span class="keyword">ON</span>)</span><br><span class="line"><span class="comment"># Find Boost package 1.66.0</span></span><br><span class="line"><span class="keyword">find_package</span>(Boost REQUIRED COMPONENTS serialization date_time system filesystem thread timer)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;Boost_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(demo <span class="variable">$&#123;Boost_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="GTest"><a href="#GTest" class="headerlink" title="GTest"></a>GTest</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/google/googletest.git</span><br></pre></td></tr></table></figure>

<blockquote>
<p>install to <code>C:\Program Files\gtest</code> on windows.</p>
</blockquote>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(MSVC) </span><br><span class="line">	<span class="keyword">SET</span>(GTEST_ROOT <span class="string">&quot;C:/Program Files/gtest&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">	<span class="comment"># BOOST_THREAD_LIBRARY  /usr/lib/x86_64-linux-gnu/libpthread.so</span></span><br><span class="line">	<span class="keyword">MESSAGE</span>( [Main] <span class="string">&quot; BOOST_THREAD_LIBRARY = $&#123;BOOST_THREAD_LIBRARY&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>(MSVC)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(GTest REQUIRED) <span class="comment"># GTest 1.8.0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(GTest REQUIRED) <span class="comment"># GTest 1.8.0</span></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;GTEST_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(demo <span class="variable">$&#123;GTEST_LIBRARIES&#125;</span> <span class="variable">$&#123;BOOST_THREAD_LIBRARY&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="gflags-glog"><a href="#gflags-glog" class="headerlink" title="gflags+glog"></a>gflags+glog</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/schuhschuh/gflags/archive/v2.2.1.tar.gz</span><br><span class="line">wget https://github.com/google/glog/archive/v0.3.5.tar.gz</span><br></pre></td></tr></table></figure>

<blockquote>
<p>for <code>find_package(GFLAGS REQUIRED)</code> we copy user-defined <code>gflags-config.cmake</code> from <code>caffe</code> project to <code>/usr/local/lib/cmake/gflags</code><br>for <code>find_package(GLOG REQUIRED)</code> we copy user-defined <code>glog-config.cmake</code> from <code>caffe</code> project to <code>/usr/local/lib/cmake/glog</code><br>see <a target="_blank" rel="noopener" href="http://www.kezunlin.me/post/977f5125/">compile glog and glags on ubuntu 16.04</a></p>
</blockquote>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(GFLAGS REQUIRED) </span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;GFLAGS_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(GLOG REQUIRED) </span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;GLOG_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># for windows</span></span><br><span class="line"><span class="comment">#add_definitions( -DGLOG_NO_ABBREVIATED_SEVERITIES ) </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(demo glog_main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span> (demo  <span class="variable">$&#123;GLOG_LIBRARIES&#125;</span> <span class="variable">$&#123;GFLAGS_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="mysqlconcpp"><a href="#mysqlconcpp" class="headerlink" title="mysqlconcpp"></a>mysqlconcpp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-cache search libmysqlcppconn</span><br><span class="line"><span class="built_in">sudo</span> apt-get -y install libmysqlcppconn-dev libmysqlcppconn7v5</span><br></pre></td></tr></table></figure>

<blockquote>
<p>for <code>find_package(MYSQLCPPCONN REQUIRED)</code> we copy user-defined <code>mysqlcppconn-config.cmake</code> to <code>/usr/lib/cmake/mysqlcppconn</code></p>
</blockquote>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(MYSQLCPPCONN REQUIRED)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;MYSQLCPPCONN_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span> (demo  <span class="variable">$&#123;MYSQLCPPCONN_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="libjpegturbo"><a href="#libjpegturbo" class="headerlink" title="libjpegturbo"></a>libjpegturbo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/libjpeg-turbo/libjpeg-turbo.git</span><br></pre></td></tr></table></figure>

<blockquote>
<p>for <code>find_package(LIBJPEGTURBO REQUIRED)</code> we copy user-defined <code>libjpegturbo-config.cmake</code> to <code>/usr/lib/cmake/libjpegturbo</code></p>
</blockquote>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(LIBJPEGTURBO REQUIRED)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;LIBJPEGTURBO_INCLUDE_DIRS&#125;</span>)  </span><br><span class="line"><span class="keyword">target_link_libraries</span> (example_jpeg <span class="variable">$&#123;LIBJPEGTURBO_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Poco"><a href="#Poco" class="headerlink" title="Poco"></a>Poco</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://pocoproject.org/releases/poco-1.8.1/poco-1.8.1.zip</span><br><span class="line">wget https://pocoproject.org/releases/poco-1.8.1/poco-1.8.1.tar.gz</span><br></pre></td></tr></table></figure>

<p>CMakeLists.txt</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(Poco REQUIRED COMPONENTS Foundation Util Net XML JSON)</span><br><span class="line"></span><br><span class="line"><span class="comment"># no Poco_INCLUDE_DIRS, we have to set by hand </span></span><br><span class="line"><span class="keyword">if</span>(MSVC) <span class="comment"># WIN32</span></span><br><span class="line">	<span class="keyword">SET</span>(Poco_INCLUDE_DIRS <span class="string">&quot;C:/Program Files/Poco/include&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">	<span class="keyword">SET</span>(Poco_INCLUDE_DIRS <span class="string">&quot;/usr/local/include/Poco&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>(MSVC)</span><br><span class="line"></span><br><span class="line"><span class="keyword">MESSAGE</span>( [Main] <span class="string">&quot; Poco_INCLUDE_DIRS = $&#123;Poco_INCLUDE_DIRS&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">MESSAGE</span>( [Main] <span class="string">&quot; Poco_LIBRARIES = $&#123;Poco_LIBRARIES&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;Poco_INCLUDE_DIRS&#125;</span> )   </span><br><span class="line"><span class="keyword">target_link_libraries</span>(demo <span class="variable">$&#123;Poco_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h3 id="OpenCV"><a href="#OpenCV" class="headerlink" title="OpenCV"></a>OpenCV</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(OpenCV REQUIRED COMPONENTS core highgui imgproc features2d calib3d) </span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;OpenCV_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(demo <span class="variable">$&#123;OpenCV_LIBS&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="QT"><a href="#QT" class="headerlink" title="QT"></a>QT</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Find includes in corresponding build directories</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_INCLUDE_CURRENT_DIR <span class="keyword">ON</span>)</span><br><span class="line"><span class="comment"># Instruct CMake to run moc automatically when needed.</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_AUTOMOC <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find the QtWidgets library</span></span><br><span class="line"><span class="keyword">find_package</span>(Qt5Core)</span><br><span class="line"><span class="keyword">find_package</span>(Qt5Widgets)</span><br><span class="line"><span class="keyword">find_package</span>(Qt5Gui)</span><br><span class="line"><span class="keyword">find_package</span>(Qt5OpenGL)</span><br><span class="line"><span class="keyword">find_package</span>(Qt5Xml)</span><br><span class="line"></span><br><span class="line"><span class="comment"># cpp files</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(. SRC_LIST)</span><br><span class="line"><span class="comment"># ui files</span></span><br><span class="line">qt5_wrap_ui(ui_FILES mainwindow.ui)</span><br><span class="line"><span class="comment"># resource files</span></span><br><span class="line">qt5_add_resources(qrc_FILES resource.qrc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( [Main] <span class="variable">$&#123;SRC_LIST&#125;</span> ) <span class="comment"># ./main.cpp./mainwindow.cpp</span></span><br><span class="line"><span class="keyword">message</span>( [Main] <span class="variable">$&#123;ui_FILES&#125;</span> ) <span class="comment"># build/ui_mainwindow.h</span></span><br><span class="line"><span class="keyword">message</span>( [Main] <span class="variable">$&#123;qrc_FILES&#125;</span> )<span class="comment"># build/qrc_resource.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Tell CMake to create the helloworld executable</span></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;SRC_LIST&#125;</span> <span class="variable">$&#123;ui_FILES&#125;</span> <span class="variable">$&#123;qrc_FILES&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">qt5_use_modules</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> Core Widgets OpenGL Xml Gui)</span><br></pre></td></tr></table></figure>

<h3 id="VTK"><a href="#VTK" class="headerlink" title="VTK"></a>VTK</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(VTK <span class="number">8.1</span> REQUIRED)</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$&#123;VTK_USE_FILE&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(CylinderRenderingProperties MACOSX_BUNDLE CylinderRenderingProperties.cxx )</span><br><span class="line"> </span><br><span class="line"><span class="keyword">target_link_libraries</span>(CylinderRenderingProperties <span class="variable">$&#123;VTK_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="PCL"><a href="#PCL" class="headerlink" title="PCL"></a>PCL</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(PCL <span class="number">1.8</span>.<span class="number">1</span> REQUIRED)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;PCL_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">link_directories</span>(<span class="variable">$&#123;PCL_LIBRARY_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">add_definitions</span>(<span class="variable">$&#123;PCL_DEFINITIONS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span> (cloud_viewer cloud_viewer.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span> (cloud_viewer <span class="variable">$&#123;PCL_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<p>or with components</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(PCL <span class="number">1.8</span>.<span class="number">1</span> REQUIRED COMPONENTS common io filters visualization)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(cloud_viewer </span><br><span class="line">	<span class="variable">$&#123;PCL_COMMON_LIBRARIES&#125;</span></span><br><span class="line">	<span class="variable">$&#123;PCL_IO_LIBRARIES&#125;</span></span><br><span class="line">	<span class="variable">$&#123;PCL_FILTERS_LIBRARIES&#125;</span></span><br><span class="line">	<span class="variable">$&#123;PCL_VISUALIZATION_LIBRARIES&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>


<h2 id="User-defined-cmake"><a href="#User-defined-cmake" class="headerlink" title="User-defined cmake"></a>User-defined cmake</h2><h3 id="gflags-config-cmake"><a href="#gflags-config-cmake" class="headerlink" title="gflags-config.cmake"></a>gflags-config.cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(GFLAGS_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(GFLAGS_VERSION <span class="number">2.2</span>.<span class="number">0</span>)</span><br><span class="line"><span class="keyword">set</span>(GFLAGS_ROOT_DIR <span class="string">&quot;C:/car_libs/gflags&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(GFLAGS_INCLUDE_DIR NAMES gflags/gflags.h PATHS <span class="string">&quot;$&#123;GFLAGS_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GFLAGS_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(GFLAGS_LIBRARY NAMES gflags.lib PATHS <span class="string">&quot;$&#123;GFLAGS_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GFLAGS_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(GFLAGS_INCLUDE_DIRS <span class="variable">$&#123;GFLAGS_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(GFLAGS_LIBRARIES <span class="variable">$&#123;GFLAGS_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;gflags-config.cmake &quot;</span> <span class="variable">$&#123;GFLAGS_ROOT_DIR&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="glog-config-cmake"><a href="#glog-config-cmake" class="headerlink" title="glog-config.cmake"></a>glog-config.cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(GLOG_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(GLOG_VERSION <span class="number">0.3</span>.<span class="number">5</span>)</span><br><span class="line"><span class="keyword">set</span>(GLOG_ROOT_DIR <span class="string">&quot;C:/car_libs/glog&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(GLOG_INCLUDE_DIR NAMES glog/logging.h PATHS <span class="string">&quot;$&#123;GLOG_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GLOG_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(GLOG_LIBRARY NAMES glog.lib PATHS <span class="string">&quot;$&#123;GLOG_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GLOG_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(GLOG_INCLUDE_DIRS <span class="variable">$&#123;GLOG_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(GLOG_LIBRARIES <span class="variable">$&#123;GLOG_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;glog-config.cmake &quot;</span> <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="mysqlconcpp-config-cmake"><a href="#mysqlconcpp-config-cmake" class="headerlink" title="mysqlconcpp-config.cmake"></a>mysqlconcpp-config.cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(MYSQLCPPCONN_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(MYSQLCPPCONN_VERSION <span class="number">1.1</span>)</span><br><span class="line"><span class="keyword">set</span>(MYSQLCPPCONN_ROOT_DIR <span class="string">&quot;C:/car_libs/mysqlcppconn&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(MYSQLCPPCONN_INCLUDE_DIR NAMES cppconn/driver.h PATHS <span class="string">&quot;$&#123;MYSQLCPPCONN_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(MYSQLCPPCONN_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(MYSQLCPPCONN_LIBRARY NAMES mysqlcppconn.lib PATHS <span class="string">&quot;$&#123;MYSQLCPPCONN_ROOT_DIR&#125;/lib/opt&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(MYSQLCPPCONN_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(MYSQLCPPCONN_INCLUDE_DIRS <span class="variable">$&#123;MYSQLCPPCONN_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(MYSQLCPPCONN_LIBRARIES <span class="variable">$&#123;MYSQLCPPCONN_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># cmake entry will be saved to build/CMakeCache.txt </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;mysqlcppconn-config.cmake &quot;</span> <span class="variable">$&#123;MYSQLCPPCONN_ROOT_DIR&#125;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="libjpegturbo-config-cmake"><a href="#libjpegturbo-config-cmake" class="headerlink" title="libjpegturbo-config.cmake"></a>libjpegturbo-config.cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_VERSION <span class="number">1.5</span>.<span class="number">4</span>)</span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_ROOT_DIR <span class="string">&quot;C:/car_libs/libjpeg-turbo64&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(LIBJPEGTURBO_INCLUDE_DIR NAMES jpeglib.h turbojpeg.h PATHS <span class="string">&quot;$&#123;LIBJPEGTURBO_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(LIBJPEGTURBO_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(LIBJPEGTURBO_JPEG_LIBRARY NAMES jpeg.lib PATHS <span class="string">&quot;$&#123;LIBJPEGTURBO_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(LIBJPEGTURBO_JPEG_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(LIBJPEGTURBO_TURBOJPEG_LIBRARY NAMES turbojpeg.lib PATHS <span class="string">&quot;$&#123;LIBJPEGTURBO_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(LIBJPEGTURBO_TURBOJPEG_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_INCLUDE_DIRS <span class="variable">$&#123;LIBJPEGTURBO_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_LIBRARIES <span class="variable">$&#123;LIBJPEGTURBO_JPEG_LIBRARY&#125;</span> <span class="variable">$&#123;LIBJPEGTURBO_TURBOJPEG_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;libjpegturbo-config.cmake &quot;</span> <span class="variable">$&#123;LIBJPEGTURBO_ROOT_DIR&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="winpcap"><a href="#winpcap" class="headerlink" title="winpcap"></a>winpcap</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(WINPCAP_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(WINPCAP_VERSION <span class="number">1.0</span>.<span class="number">0</span>)</span><br><span class="line"><span class="keyword">set</span>(WINPCAP_ROOT_DIR <span class="string">&quot;C:/car_libs/winpcap&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(WINPCAP_INCLUDE_DIR NAMES pcap.h PATHS <span class="string">&quot;$&#123;WINPCAP_ROOT_DIR&#125;/Include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(WINPCAP_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(WINPCAP_LIBRARY NAMES wpcap.lib PATHS <span class="string">&quot;$&#123;WINPCAP_ROOT_DIR&#125;/Lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(WINPCAP_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(WINPCAP_INCLUDE_DIRS <span class="variable">$&#123;WINPCAP_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(WINPCAP_LIBRARIES <span class="variable">$&#123;WINPCAP_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;winpcap-config.cmake &quot;</span> <span class="variable">$&#123;WINPCAP_ROOT_DIR&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="OpenNI2"><a href="#OpenNI2" class="headerlink" title="OpenNI2"></a>OpenNI2</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(OPENNI2_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(OPENNI2_VERSION <span class="number">1.0</span>.<span class="number">0</span>)</span><br><span class="line"><span class="keyword">set</span>(OPENNI2_ROOT_DIR <span class="string">&quot;C:/car_libs/OpenNI2&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(OPENNI2_INCLUDE_DIR NAMES OpenNI.h PATHS <span class="string">&quot;$&#123;OPENNI2_ROOT_DIR&#125;/Include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(OPENNI2_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(OPENNI2_LIBRARY NAMES OpenNI2.lib PATHS <span class="string">&quot;$&#123;OPENNI2_ROOT_DIR&#125;/Lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(OPENNI2_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(OPENNI2_INCLUDE_DIRS <span class="variable">$&#123;OPENNI2_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(OPENNI2_LIBRARIES <span class="variable">$&#123;OPENNI2_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;openni2-config.cmake &quot;</span> <span class="variable">$&#123;OPENNI2_ROOT_DIR&#125;</span>)</span><br></pre></td></tr></table></figure>


<h2 id="CMake-Options"><a href="#CMake-Options" class="headerlink" title="CMake Options"></a>CMake Options</h2><h3 id="how-to-find-package"><a href="#how-to-find-package" class="headerlink" title="how to find_package"></a>how to find_package</h3><h4 id="CMAKE-PREFIX-PATH-find-package"><a href="#CMAKE-PREFIX-PATH-find-package" class="headerlink" title="CMAKE_PREFIX_PATH + find_package"></a>CMAKE_PREFIX_PATH + find_package</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(ROOT_CMAKE_DIR /home/user/program/anakin/sdk/cmake)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_PREFIX_PATH <span class="variable">$&#123;CMAKE_PREFIX_PATH&#125;</span> <span class="string">&quot;$&#123;ROOT_CMAKE_DIR&#125;;$&#123;CMAKE_PREFIX_PATH&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">MESSAGE</span>( [cmake] <span class="string">&quot; CMAKE_PREFIX_PATH = $&#123;CMAKE_PREFIX_PATH&#125; for find_package&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># find anakin-config.cmake file in CMAKE_PREFIX_PATH </span></span><br><span class="line"><span class="keyword">find_package</span>(ANAKIN REQUIRED)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;ANAKIN_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( [anakin] <span class="variable">$&#123;ANAKIN_INCLUDE_DIRS&#125;</span> )</span><br><span class="line"><span class="keyword">message</span>( [anakin] <span class="variable">$&#123;ANAKIN_LIBRARIES&#125;</span> )</span><br></pre></td></tr></table></figure>

<h4 id="include-xxx-config-cmake"><a href="#include-xxx-config-cmake" class="headerlink" title="include xxx-config.cmake"></a>include xxx-config.cmake</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>(cmake/anakin-config.cmake)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;ANAKIN_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( [anakin] <span class="variable">$&#123;ANAKIN_INCLUDE_DIRS&#125;</span> )</span><br><span class="line"><span class="keyword">message</span>( [anakin] <span class="variable">$&#123;ANAKIN_LIBRARIES&#125;</span> )</span><br></pre></td></tr></table></figure>

<h3 id="c-11"><a href="#c-11" class="headerlink" title="c++11"></a>c++11</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(CMAKE_CXX_FLAGS <span class="string">&quot;$&#123;CMAKE_CXX_FLAGS&#125; -std=c++11&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/UnaNancyOwen/VelodyneCapture/blob/master/sample/viewer/FindPCAP.cmake">FindPCAP cmake example</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180208: created.</li>
<li>20180301: add xxx-config.cmake.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/compile-glog-and-glags-on-windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/compile-glog-and-glags-on-windows/" class="post-title-link" itemprop="url">compile glog and glags on windows</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-02-06 14:49:00" itemprop="dateCreated datePublished" datetime="2018-02-06T14:49:00+08:00">2018-02-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><ul>
<li><strong><a href="https://kezunlin.me/post/bb64e398/">compile glog and glags on windows</a></strong></li>
<li><a href="https://kezunlin.me/post/977f5125/">compile glog and glags on ubuntu 16.04</a></li>
</ul>
<h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><ul>
<li>glog:  v0.3.5  <a target="_blank" rel="noopener" href="https://github.com/google/glog/archive/v0.3.5.zip">https://github.com/google/glog/archive/v0.3.5.zip</a></li>
<li>gflag: v2.2.1  <a target="_blank" rel="noopener" href="https://github.com/schuhschuh/gflags/archive/v2.2.1.zip">https://github.com/schuhschuh/gflags/archive/v2.2.1.zip</a></li>
</ul>
<h3 id="gflags"><a href="#gflags" class="headerlink" title="gflags"></a>gflags</h3><blockquote>
<p>do not use offical version,instead use <code>https://github.com/schuhschuh/gflags.git</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/schuhschuh/gflags.git </span><br><span class="line"><span class="built_in">cd</span> gflags</span><br><span class="line"><span class="built_in">mkdir</span> windows-build</span><br><span class="line"><span class="built_in">cd</span> windows-build</span><br><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>

<p>with options </p>
<pre><code>BUILD_SHARED_LIBS ON 
INSTALL_SHARED_LIBS ON
INSTALL_STATIC_LIBS OFF
CMAKE_CONFIGURATION_TYPES Release # Release
REGISTER_INSTALL_PREFIX OFF

CMAKE_INSTALL_PREFIX D:/gflags
#NAMESPACE google;gflags
NAMESPACE google
</code></pre>
<p>or command </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DGFLAGS_NAMESPACE=google -DCMAKE_CXX_FLAGS=-fPIC ..</span><br></pre></td></tr></table></figure>

<blockquote>
<p>we get <code>include</code> and <code>lib/gflags.lib</code>, and <code>bin/gflags.dll</code><br>modify <code>CMAKE/CMAKE_INSTALL_PREFIX</code> to a non-system folder, otherwise you will need administrative privileges to run INSTALL project.</p>
</blockquote>
<h3 id="glog"><a href="#glog" class="headerlink" title="glog"></a>glog</h3><blockquote>
<p>Notice:<br>we have to new entry with <code>BUILD_SHARED_LIB</code> with value <code>ON </code>, because by default, <code>glog</code> is <code>static library</code> with extension <code>.lib</code>.</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/google/glog/archive/v0.3.5.zip</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> windows-build</span><br><span class="line"><span class="built_in">cd</span> windows-build</span><br><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>

<p>with options </p>
<pre><code>#WITH_GFLAGS ON 
#gflags_DIR D:/gflags/lib/cmake/gflags

WITH_GFLAGS OFF
CMAKE_INSTALL_DIR d:/glog
CMAKE_CONFIGURATION_TYPES Release # Release

BUILD_SHARED_LIBS ON  # new by hand
</code></pre>
<p>generate <code>sln</code> and open with <code>Visual Studio 2015</code> compile and install.</p>
<p>and we get preprocessors from <code>glog</code></p>
<pre><code>WIN32
_WINDOWS
NDEBUG
GLOG_NO_ABBREVIATED_SEVERITIES
GOOGLE_GLOG_IS_A_DLL=1
GOOGLE_GLOG_DLL_DECL=__declspec(dllexport)
GFLAGS_IS_A_DLL=1
CMAKE_INTDIR=&quot;Release&quot;
LIBGLOG_EXPORTS
</code></pre>
<blockquote>
<p>we get <code>include</code> and <code>lib/glog.lib</code>, and <code>bin/glog.dll</code></p>
</blockquote>
<h3 id="multiple-processor-compile"><a href="#multiple-processor-compile" class="headerlink" title="multiple processor compile"></a>multiple processor compile</h3><ul>
<li>windows: <code>set_target_properties(main PROPERTIES COMPILE_FLAGS &quot;/MP&quot;)</code></li>
<li>linux: <code>make -j8</code></li>
</ul>
<p>with cmake options <code>/MD</code> added to <code>CMAKE_CXX_FLAGS_RELEASE</code></p>
<pre><code>CMAKE_CXX_FLAGS_RELEASE /MD /O2 /Ob2 /DNDEBUG /MP
</code></pre>
<p>or </p>
<p>with <code>CMakeLists.txt</code></p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(MSVC) <span class="comment"># WIN32</span></span><br><span class="line">  <span class="keyword">set_target_properties</span>(target1 PROPERTIES COMPILE_FLAGS <span class="string">&quot;/MP&quot;</span>)</span><br><span class="line">  <span class="keyword">set_target_properties</span>(target2 PROPERTIES COMPILE_FLAGS <span class="string">&quot;/MP&quot;</span>)</span><br><span class="line">  <span class="keyword">set_target_properties</span>(target3 PROPERTIES COMPILE_FLAGS <span class="string">&quot;/MP&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>

<h3 id="project-dependency"><a href="#project-dependency" class="headerlink" title="project dependency"></a>project dependency</h3><p>select <code>ALL-BUILD</code> and change build order by hand.</p>
<pre><code>ZERO_CHECK
CarConfig
CarUtil
CarModel
CarDatabase
a_main
a_unit_tests
data_client
data_server
example_jpeg
example_thread
ALL_BUILD
</code></pre>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<h2 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code"></a>Example Code</h2><h3 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#find_package(glog 0.3.5 REQUIRED)  </span></span><br><span class="line"><span class="comment"># no GLOG_INCLUDE_DIRS  GLOG_LIBRARIES, we only use  `glog::glog` as target</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(glog REQUIRED) </span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(main main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span> (main  glog::glog)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>glog include directory will be imported automatically.</p>
</blockquote>
<h3 id="gflags-config-cmake"><a href="#gflags-config-cmake" class="headerlink" title="gflags-config.cmake"></a>gflags-config.cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(GFLAGS_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(GFLAGS_ROOT_DIR <span class="string">&quot;D:/gflags&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(GFLAGS_INCLUDE_DIR NAMES gflags/gflags.h PATHS <span class="string">&quot;$&#123;GFLAGS_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GFLAGS_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(GFLAGS_LIBRARY NAMES gflags.lib PATHS <span class="string">&quot;$&#123;GFLAGS_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GFLAGS_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(GFLAGS_INCLUDE_DIRS <span class="variable">$&#123;GFLAGS_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(GFLAGS_LIBRARIES <span class="variable">$&#123;GFLAGS_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;gflags-config.cmake &quot;</span> <span class="variable">$&#123;GFLAGS_ROOT_DIR&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="glog-config-cmake"><a href="#glog-config-cmake" class="headerlink" title="glog-config.cmake"></a>glog-config.cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(GLOG_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(GLOG_ROOT_DIR <span class="string">&quot;D:/glog&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(GLOG_INCLUDE_DIR NAMES glog/logging.h PATHS <span class="string">&quot;$&#123;GLOG_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GLOG_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(GLOG_LIBRARY NAMES glog.lib PATHS <span class="string">&quot;$&#123;GLOG_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(GLOG_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(GLOG_INCLUDE_DIRS <span class="variable">$&#123;GLOG_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(GLOG_LIBRARIES <span class="variable">$&#123;GLOG_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;glog-config.cmake &quot;</span> <span class="variable">$&#123;GLOG_ROOT_DIR&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;gflags/gflags.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;glog/logging.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	FLAGS_logtostderr = true;  </span></span><br><span class="line"><span class="comment">	FLAGS_alsologtostderr = true;  </span></span><br><span class="line"><span class="comment">	FLAGS_colorlogtostderr = true;  </span></span><br><span class="line"><span class="comment">	FLAGS_log_prefix = true;  </span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	FLAGS_logbufsecs = 0;  //0 means realtime</span></span><br><span class="line"><span class="comment">	FLAGS_max_log_size = 10;  // MB</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	google::<span class="built_in">InitGoogleLogging</span>(argv[<span class="number">0</span>]); <span class="comment">// init google logging</span></span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_FATAL, <span class="string">&quot;../log/log_fatal_&quot;</span>); </span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_ERROR, <span class="string">&quot;../log/log_error_&quot;</span>); </span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_WARNING, <span class="string">&quot;../log/log_warning_&quot;</span>);</span><br><span class="line">	google::<span class="built_in">SetLogDestination</span>(google::GLOG_INFO, <span class="string">&quot;../log/log_info_&quot;</span>); </span><br><span class="line"></span><br><span class="line">	<span class="built_in">LOG</span>(INFO) &lt;&lt; <span class="string">&quot;Hello GLOG&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>copy <code>gflags.dll</code> and <code>glog.dll</code> to main executable folder.</p>
</blockquote>
<h3 id="errors"><a href="#errors" class="headerlink" title="errors"></a>errors</h3><p>error:</p>
<pre><code>fatal error C1189: #error :  ERROR macro is defined. Define GLOG_NO_ABBREVIATED_SEVERITIES before including logging.h. See the document for detail.  
</code></pre>
<p> solution:</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(GFLAGS REQUIRED) <span class="comment"># user-defined</span></span><br><span class="line"><span class="keyword">find_package</span>(GLOG REQUIRED) <span class="comment"># user-defined</span></span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;GFLAGS_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;GLOG_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add macro GLOG_NO_ABBREVIATED_SEVERITIES</span></span><br><span class="line"><span class="keyword">add_definitions</span>( -DGLOG_NO_ABBREVIATED_SEVERITIES ) </span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/23581621/configure-google-glog-and-gflags-for-c">configure-google-glog-and-gflags-for-c</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/30014760/building-google-glog-with-cmake-on-linux">building-google-glog-with-cmake-on-linux</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/google/glog/blob/master/cmake/INSTALL.md">glog install</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/google/glog/wiki/Installing-Glog-on-Ubuntu-14.04">Installing-Glog-on-Ubuntu-14.04</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/41766969/installing-glog-on-windows/45453491#45453491">installing-glog-on-windows</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180206: created.</li>
<li>20180207: add multiple processor and build dependency part for windows.</li>
<li>20180209: add error and solutions</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/std-move-example/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/std-move-example/" class="post-title-link" itemprop="url">std::move example</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-02-01 10:27:00" itemprop="dateCreated datePublished" datetime="2018-02-01T10:27:00+08:00">2018-02-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="copy-constructors-and-copy-assignment-operators"><a href="#copy-constructors-and-copy-assignment-operators" class="headerlink" title="copy constructors and copy assignment operators"></a>copy constructors and copy assignment operators</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MemoryBlock</span>(<span class="type">const</span> MemoryBlock&amp; other)</span><br><span class="line">MemoryBlock&amp; <span class="keyword">operator</span>=(<span class="type">const</span> MemoryBlock&amp; other)</span><br></pre></td></tr></table></figure>

<h3 id="move-constructors-and-move-assignment-operators"><a href="#move-constructors-and-move-assignment-operators" class="headerlink" title="move constructors and move assignment operators"></a>move constructors and move assignment operators</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MemoryBlock</span>(MemoryBlock&amp;&amp; other)  </span><br><span class="line">MemoryBlock&amp; <span class="keyword">operator</span>=(MemoryBlock&amp;&amp; other)  </span><br></pre></td></tr></table></figure>

<h3 id="example-move"><a href="#example-move" class="headerlink" title="example_move"></a>example_move</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemoryBlock</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Simple constructor that initializes the resource.</span></span><br><span class="line">   <span class="function"><span class="keyword">explicit</span> <span class="title">MemoryBlock</span><span class="params">(<span class="type">size_t</span> length)</span></span></span><br><span class="line"><span class="function">      : _length(length)</span></span><br><span class="line"><span class="function">      , _data(new int[length])</span></span><br><span class="line"><span class="function">   &#123;</span></span><br><span class="line">      std::cout &lt;&lt; <span class="string">&quot;In MemoryBlock(size_t). length = &quot;</span></span><br><span class="line">                &lt;&lt; _length &lt;&lt; <span class="string">&quot;.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Destructor.</span></span><br><span class="line">   ~<span class="built_in">MemoryBlock</span>()</span><br><span class="line">   &#123;</span><br><span class="line">      std::cout &lt;&lt; <span class="string">&quot;In ~MemoryBlock(). length = &quot;</span></span><br><span class="line">                &lt;&lt; _length &lt;&lt; <span class="string">&quot;.&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (_data != <span class="literal">nullptr</span>)</span><br><span class="line">      &#123;</span><br><span class="line">         std::cout &lt;&lt; <span class="string">&quot; Deleting resource.&quot;</span>;</span><br><span class="line">         <span class="comment">// Delete the resource.</span></span><br><span class="line">         <span class="keyword">delete</span>[] _data;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      std::cout &lt;&lt; std::endl;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Copy constructor.</span></span><br><span class="line">   <span class="built_in">MemoryBlock</span>(<span class="type">const</span> MemoryBlock&amp; other)</span><br><span class="line">      : _length(other._length)</span><br><span class="line">      , _data(<span class="keyword">new</span> <span class="type">int</span>[other._length])</span><br><span class="line">   &#123;</span><br><span class="line">      std::cout &lt;&lt; <span class="string">&quot;In MemoryBlock(const MemoryBlock&amp;). length = &quot;</span></span><br><span class="line">                &lt;&lt; other._length &lt;&lt; <span class="string">&quot;. Copying resource.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">      std::<span class="built_in">copy</span>(other._data, other._data + _length, _data);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Copy assignment operator.</span></span><br><span class="line">   MemoryBlock&amp; <span class="keyword">operator</span>=(<span class="type">const</span> MemoryBlock&amp; other)</span><br><span class="line">   &#123;</span><br><span class="line">      std::cout &lt;&lt; <span class="string">&quot;In operator=(const MemoryBlock&amp;). length = &quot;</span></span><br><span class="line">                &lt;&lt; other._length &lt;&lt; <span class="string">&quot;. Copying resource.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;other)</span><br><span class="line">      &#123;</span><br><span class="line">         <span class="comment">// Free the existing resource.</span></span><br><span class="line">         <span class="keyword">delete</span>[] _data;</span><br><span class="line"></span><br><span class="line">         _length = other._length;</span><br><span class="line">         _data = <span class="keyword">new</span> <span class="type">int</span>[_length];</span><br><span class="line">         std::<span class="built_in">copy</span>(other._data, other._data + _length, _data);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Retrieves the length of the data resource.</span></span><br><span class="line">   <span class="function"><span class="type">size_t</span> <span class="title">Length</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> _length;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Move constructor.</span></span><br><span class="line">    <span class="built_in">MemoryBlock</span>(MemoryBlock&amp;&amp; other)</span><br><span class="line">       : _data(<span class="literal">nullptr</span>)</span><br><span class="line">       , _length(<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       std::cout &lt;&lt; <span class="string">&quot;In MemoryBlock(MemoryBlock&amp;&amp;). length = &quot;</span></span><br><span class="line">             &lt;&lt; other._length &lt;&lt; <span class="string">&quot;. Moving resource.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Copy the data pointer and its length from the</span></span><br><span class="line">       <span class="comment">// source object.</span></span><br><span class="line">       _data = other._data;</span><br><span class="line">       _length = other._length;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Release the data pointer from the source object so that</span></span><br><span class="line">       <span class="comment">// the destructor does not free the memory multiple times.</span></span><br><span class="line">       other._data = <span class="literal">nullptr</span>;</span><br><span class="line">       other._length = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Move assignment operator.</span></span><br><span class="line">    MemoryBlock&amp; <span class="keyword">operator</span>=(MemoryBlock&amp;&amp; other)</span><br><span class="line">    &#123;</span><br><span class="line">       std::cout &lt;&lt; <span class="string">&quot;In operator=(MemoryBlock&amp;&amp;). length = &quot;</span></span><br><span class="line">                 &lt;&lt; other._length &lt;&lt; <span class="string">&quot;.&quot;</span> &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;other)</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="comment">// Free the existing resource.</span></span><br><span class="line">          <span class="keyword">delete</span>[] _data;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Copy the data pointer and its length from the</span></span><br><span class="line">          <span class="comment">// source object.</span></span><br><span class="line">          _data = other._data;</span><br><span class="line">          _length = other._length;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// Release the data pointer from the source object so that</span></span><br><span class="line">          <span class="comment">// the destructor does not free the memory multiple times.</span></span><br><span class="line">          other._data = <span class="literal">nullptr</span>;</span><br><span class="line">          other._length = <span class="number">0</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">   <span class="type">size_t</span> _length; <span class="comment">// The length of the resource.</span></span><br><span class="line">   <span class="type">int</span>* _data; <span class="comment">// The resource.</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestSTLObject</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::string str = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    std::vector&lt;std::string&gt; v;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// uses the push_back(const T&amp;) overload, which means</span></span><br><span class="line">    <span class="comment">// we&#x27;ll incur the cost of copying str</span></span><br><span class="line">    v.<span class="built_in">push_back</span>(str);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;After copy, str is \&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// uses the rvalue reference push_back(T&amp;&amp;) overload,</span></span><br><span class="line">    <span class="comment">// which means no strings will be copied; instead, the contents</span></span><br><span class="line">    <span class="comment">// of str will be moved into the vector.  This is less</span></span><br><span class="line">    <span class="comment">// expensive, but also means str might now be empty.</span></span><br><span class="line">    v.<span class="built_in">push_back</span>(std::<span class="built_in">move</span>(str));</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;After move, str is \&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;The contents of the vector are \&quot;&quot;</span> &lt;&lt; v[<span class="number">0</span>]</span><br><span class="line">                                         &lt;&lt; <span class="string">&quot;\&quot;, \&quot;&quot;</span> &lt;&lt; v[<span class="number">1</span>] &lt;&lt; <span class="string">&quot;\&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	After copy, str is &quot;Hello&quot;</span></span><br><span class="line"><span class="comment">	After move, str is &quot;&quot;</span></span><br><span class="line"><span class="comment">	The contents of the vector are &quot;Hello&quot;, &quot;Hello&quot;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestMyObjectWithoutUseMove</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   std::vector&lt;MemoryBlock&gt; v;</span><br><span class="line">   <span class="function">MemoryBlock <span class="title">mb1</span><span class="params">(<span class="number">25</span>)</span></span>;</span><br><span class="line">   <span class="comment">//MemoryBlock mb2(75);</span></span><br><span class="line">   <span class="comment">//MemoryBlock mb3(50);</span></span><br><span class="line"></span><br><span class="line">   v.<span class="built_in">push_back</span>(mb1);</span><br><span class="line">   <span class="comment">//v.push_back(mb2);</span></span><br><span class="line">   <span class="comment">//v.push_back(mb3);</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">	In MemoryBlock(size_t). length = 25.</span></span><br><span class="line"><span class="comment">	In MemoryBlock(const MemoryBlock&amp;). length = 25. Copying resource.</span></span><br><span class="line"><span class="comment">	In ~MemoryBlock(). length = 25. Deleting resource.</span></span><br><span class="line"><span class="comment">	In ~MemoryBlock(). length = 25. Deleting resource.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">TestMyObjectWithUseMove</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   std::vector&lt;MemoryBlock&gt; v;</span><br><span class="line"></span><br><span class="line">   <span class="function">MemoryBlock <span class="title">mb1</span><span class="params">(<span class="number">25</span>)</span></span>;</span><br><span class="line">   <span class="comment">// MemoryBlock mb2(75);</span></span><br><span class="line">   <span class="comment">// MemoryBlock mb3(50);</span></span><br><span class="line"></span><br><span class="line">   v.<span class="built_in">push_back</span>(std::<span class="built_in">move</span>(mb1));</span><br><span class="line">   <span class="comment">//v.push_back(MemoryBlock(75));</span></span><br><span class="line">   <span class="comment">//v.insert(v.begin() + 1, MemoryBlock(50));</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">/*</span></span><br><span class="line"><span class="comment">	In MemoryBlock(size_t). length = 25.</span></span><br><span class="line"><span class="comment">	In MemoryBlock(MemoryBlock&amp;&amp;). length = 25. Moving resource.</span></span><br><span class="line"><span class="comment">	In ~MemoryBlock(). length = 0.</span></span><br><span class="line"><span class="comment">	In ~MemoryBlock(). length = 25. Deleting resource.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//TestSTLObject();</span></span><br><span class="line">    <span class="comment">//TestMyObjectWithoutUseMove();</span></span><br><span class="line">    <span class="built_in">TestMyObjectWithUseMove</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="rewrite-move-constructor"><a href="#rewrite-move-constructor" class="headerlink" title="rewrite move constructor"></a>rewrite move constructor</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Move constructor.  </span></span><br><span class="line"><span class="built_in">MemoryBlock</span>(MemoryBlock&amp;&amp; other)  </span><br><span class="line">   : _data(<span class="literal">nullptr</span>)  </span><br><span class="line">   , _length(<span class="number">0</span>)  </span><br><span class="line">&#123;  </span><br><span class="line">   *<span class="keyword">this</span> = std::<span class="built_in">move</span>(other);  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="http://zh.cppreference.com/w/cpp/utility/move">move</a></li>
<li><a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/library/dd293665.aspx">Move Constructors and Move Assignment Operators (C++)</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/infoworld/article/details/50736633">move example</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180201: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/compile-and-use-libjpeg-turbo-on-windows-10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/compile-and-use-libjpeg-turbo-on-windows-10/" class="post-title-link" itemprop="url">compile and use libjpeg-turbo on windows 10</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-31 09:48:00" itemprop="dateCreated datePublished" datetime="2018-01-31T09:48:00+08:00">2018-01-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><ul>
<li><strong><a href="https://kezunlin.me/post/83828674/">compile and use libjpeg-turbo on windows 10</a></strong></li>
<li><a href="https://kezunlin.me/post/9f626e7a/">compile and use libjpeg-turbo on ubuntu 16.04</a></li>
</ul>
<h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="build-requirements"><a href="#build-requirements" class="headerlink" title="build requirements"></a>build requirements</h3><p>Build Requirements</p>
<ul>
<li>cmake 2.8</li>
<li>NASM 2.13</li>
<li>Visual Studio 2015</li>
<li>libjpeg-turbo 1.5.4</li>
</ul>
<blockquote>
<p>If using <code>NASM</code>, 2.05 or later is required for an x86-64 build.<br><code>nasm.exe/yasm.exe</code> should be in your PATH.</p>
</blockquote>
<h3 id="download"><a href="#download" class="headerlink" title="download"></a>download</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/libjpeg-turbo/libjpeg-turbo.git</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">wget https://codeload.github.com/libjpeg-turbo/libjpeg-turbo/zip/master</span><br></pre></td></tr></table></figure>

<h3 id="install-nasm"><a href="#install-nasm" class="headerlink" title="install nasm"></a>install nasm</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.nasm.us/pub/nasm/releasebuilds/2.13.03rc1/win64/nasm-2.13.03rc1-installer-x64.exe</span><br></pre></td></tr></table></figure>

<blockquote>
<p>add <code>C:\Program Files\NASM</code> to env path.</p>
</blockquote>
<h3 id="compile-libjpeg"><a href="#compile-libjpeg" class="headerlink" title="compile libjpeg"></a>compile libjpeg</h3> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>
<p>with options</p>
<pre><code>CMAKE_BUILD_TYPE = Release
ENABLE_SHARED = ON
CMAKE_INSTALL_PREFIX = d:/libjpeg-turbo64
NASM = C:/Program Files/NASM/nasm.exe
</code></pre>
<p> configure and generate <code>sln</code>, compile with <code>visual studio 2015</code> and install.</p>
<h3 id="usage-with-cmake"><a href="#usage-with-cmake" class="headerlink" title="usage with cmake"></a>usage with cmake</h3><h4 id="libjpegturbo-config-cmake"><a href="#libjpegturbo-config-cmake" class="headerlink" title="libjpegturbo-config.cmake"></a>libjpegturbo-config.cmake</h4> <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_FOUND <span class="keyword">TRUE</span>) <span class="comment"># auto </span></span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_ROOT_DIR <span class="string">&quot;d:/libjpeg-turbo64&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_path</span>(LIBJPEGTURBO_INCLUDE_DIR NAMES jpeglib.h turbojpeg.h PATHS <span class="string">&quot;$&#123;LIBJPEGTURBO_ROOT_DIR&#125;/include&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(LIBJPEGTURBO_INCLUDE_DIR) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(LIBJPEGTURBO_JPEG_LIBRARY NAMES jpeg.lib PATHS <span class="string">&quot;$&#123;LIBJPEGTURBO_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(LIBJPEGTURBO_JPEG_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(LIBJPEGTURBO_TURBOJPEG_LIBRARY NAMES turbojpeg.lib PATHS <span class="string">&quot;$&#123;LIBJPEGTURBO_ROOT_DIR&#125;/lib&quot;</span>) </span><br><span class="line"><span class="keyword">mark_as_advanced</span>(LIBJPEGTURBO_TURBOJPEG_LIBRARY) <span class="comment"># show entry in cmake-gui</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># use xxx_INCLUDE_DIRS and xxx_LIBRARIES in CMakeLists.txt</span></span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_INCLUDE_DIRS <span class="variable">$&#123;LIBJPEGTURBO_INCLUDE_DIR&#125;</span> )</span><br><span class="line"><span class="keyword">set</span>(LIBJPEGTURBO_LIBRARIES <span class="variable">$&#123;LIBJPEGTURBO_JPEG_LIBRARY&#125;</span> <span class="variable">$&#123;LIBJPEGTURBO_TURBOJPEG_LIBRARY&#125;</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">message</span>( <span class="string">&quot;libjpegturbo-config.cmake &quot;</span> <span class="variable">$&#123;LIBJPEGTURBO_ROOT_DIR&#125;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h4> <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">find_package</span>(LIBJPEGTURBO REQUIRED)</span><br><span class="line"> <span class="keyword">include_directories</span>(<span class="variable">$&#123;LIBJPEGTURBO_INCLUDE_DIRS&#125;</span>)  </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">add_executable</span> (example_jpeg</span><br><span class="line">    <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/src/example/example_jpeg.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span> (example_jpeg </span><br><span class="line">	<span class="variable">$&#123;LIBJPEGTURBO_LIBRARIES&#125;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span> (example_turbojpeg</span><br><span class="line">    <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>/src/example/example_turbojpeg.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span> (example_turbojpeg </span><br><span class="line">	<span class="variable">$&#123;LIBJPEGTURBO_LIBRARIES&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
 <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h2 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code"></a>Example Code</h2><h3 id="jpeglib-vs-turbojpeg"><a href="#jpeglib-vs-turbojpeg" class="headerlink" title="jpeglib vs turbojpeg"></a>jpeglib vs turbojpeg</h3><p>jpeglib </p>
<ul>
<li>include: <code>#include &quot;jpeglib.h&quot;</code></li>
<li>lib: <code>jpeg.lib</code></li>
<li>dll: <code>jpeg62.dll</code></li>
</ul>
<p>turbojpeg</p>
<ul>
<li>include: <code>#include &quot;turbojpeg.h&quot;</code></li>
<li>lib: <code>turbojpeg.lib</code></li>
<li>dll: <code>turbojpeg.dll</code></li>
</ul>
<p>turbojpeg is (3-5x) faster than jpeglib.</p>
<h3 id="jpeglib"><a href="#jpeglib" class="headerlink" title="jpeglib"></a>jpeglib</h3><p>see <a href="https://kezunlin.me/downloads/code/jpeglib.cpp">jpeglib.cpp</a></p>
<h3 id="turbojpeg"><a href="#turbojpeg" class="headerlink" title="turbojpeg"></a>turbojpeg</h3><p>see <a href="https://kezunlin.me/downloads/code/turbojpeg.cpp">turbojpeg.cpp</a></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/libjpeg-turbo/libjpeg-turbo/master/example.c">example.c</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/libjpeg-turbo/libjpeg-turbo/blob/master/BUILDING.md">building</a></li>
<li><a target="_blank" rel="noopener" href="https://libjpeg-turbo.org/Documentation/Documentation">turbo offical doc</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/hzhida/archive/2012/05/30/2524989.html">compress and decompress jpeg</a></li>
<li><a target="_blank" rel="noopener" href="https://my.oschina.net/u/733649/blog/485323">opencv imdecode to libjpeg-turbo</a> (good)</li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/9094691/examples-or-tutorials-of-using-libjpeg-turbos-turbojpeg">tjcompress and tjdecompress</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180201: created.</li>
<li>20180202: add example code.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/compile-and-use-boost-on-ubuntu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/compile-and-use-boost-on-ubuntu/" class="post-title-link" itemprop="url">compile boost 1.66.0 from source on ubuntu 16.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-31 06:30:00" itemprop="dateCreated datePublished" datetime="2018-01-31T06:30:00+08:00">2018-01-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><ul>
<li><strong><a href="https://kezunlin.me/post/d5d4a460/">compile boost 1.66.0 from source on ubuntu 16.04</a></strong></li>
<li><a href="https://kezunlin.me/post/854071ac/">compile boost 1.66.0 from source on windows 10</a></li>
</ul>
<h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="apt-get"><a href="#apt-get" class="headerlink" title="apt-get"></a><del>apt-get</del></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.58 for ubuntu 16.04</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install libboost-all-dev</span><br></pre></td></tr></table></figure>

<h3 id="compile-from-source"><a href="#compile-from-source" class="headerlink" title="compile from source"></a>compile from source</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.bintray.com/boostorg/release/1.66.0/source/boost_1_66_0.tar.gz</span><br><span class="line"></span><br><span class="line">tar xzvf boost_1_66_0.tar.gz</span><br><span class="line"><span class="built_in">cd</span> boost_1_66_0/</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get install build-essential g++ python-dev autotools-dev libicu-dev build-essential libbz2-dev</span><br><span class="line"></span><br><span class="line">./bootstrap.sh --prefix=/usr/local/</span><br><span class="line"></span><br><span class="line">./b2 --<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line">./b2 -j8 variant=release <span class="built_in">link</span>=shared threading=multi runtime-link=shared</span><br><span class="line"><span class="built_in">sudo</span> ./b2 -j8 install </span><br></pre></td></tr></table></figure>

<h3 id="thread-example"><a href="#thread-example" class="headerlink" title="thread example"></a>thread example</h3><h4 id="thread-demo-cpp"><a href="#thread-demo-cpp" class="headerlink" title="thread_demo.cpp"></a>thread_demo.cpp</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//#include &lt;boost/thread/thread.hpp&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;boost/thread/mutex.hpp&gt;</span></span><br><span class="line"><span class="comment">//#include &lt;boost/bind/bind.hpp&gt;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/thread.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/bind.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">boost::mutex io_mutex;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">count</span><span class="params">(<span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		boost::<span class="function">mutex::scoped_lock <span class="title">lock</span><span class="params">(io_mutex)</span></span>;</span><br><span class="line">		std::cout &lt;&lt; id &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; i &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">boost::thread <span class="title">thrd1</span><span class="params">(boost::bind(&amp;count, <span class="number">1</span>))</span></span>;</span><br><span class="line">	<span class="function">boost::thread <span class="title">thrd2</span><span class="params">(boost::bind(&amp;count, <span class="number">2</span>))</span></span>;</span><br><span class="line">	thrd<span class="number">1.</span><span class="built_in">join</span>();</span><br><span class="line">	thrd<span class="number">2.</span><span class="built_in">join</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">2.6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span> (thread_main)</span><br><span class="line"><span class="keyword">enable_language</span>(C)</span><br><span class="line"><span class="keyword">enable_language</span>(CXX)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(Boost_USE_RELEASE_LIBS <span class="keyword">ON</span>)</span><br><span class="line"><span class="comment">#set(Boost_USE_STATIC_LIBS OFF) # use .a or .so file</span></span><br><span class="line"><span class="keyword">set</span>(Boost_USE_MULTITHREAD <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find Boost package 1.5.8 or 1.6.6</span></span><br><span class="line"><span class="keyword">find_package</span>(Boost <span class="number">1.5</span>.<span class="number">8</span> REQUIRED COMPONENTS serialization date_time system filesystem thread timer)</span><br><span class="line"><span class="keyword">include_directories</span>(<span class="variable">$&#123;Boost_INCLUDE_DIRS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span> (thread_main</span><br><span class="line">	thread_main.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span> (thread_main </span><br><span class="line">	<span class="variable">$&#123;Boost_LIBRARIES&#125;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="thread-pool"><a href="#thread-pool" class="headerlink" title="thread pool"></a>thread pool</h3><p>see <a href="https://kezunlin.me/post/f241bd30/">thread pool with boost</a></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/19500404/how-to-create-a-thread-pool-using-boost-in-c">how-to-create-a-thread-pool-using-boost-in-c</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangguchangqing/p/6134635.html">multi thread</a></li>
<li><a target="_blank" rel="noopener" href="http://zh.highscore.de/cpp/boost/asio.html">boost asio ref</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12578499/how-to-install-boost-on-ubuntu">how-to-install-boost-on-ubuntu</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180131: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/serialize-and-deserialize-a-class-in-cpp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/serialize-and-deserialize-a-class-in-cpp/" class="post-title-link" itemprop="url">serialize and deserialize a class in cpp with boost</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-28 03:28:00" itemprop="dateCreated datePublished" datetime="2018-01-28T03:28:00+08:00">2018-01-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="how-to-serialize-string"><a href="#how-to-serialize-string" class="headerlink" title="how to serialize string"></a>how to serialize string</h3><p>size + data</p>
<blockquote>
<p>The easiest serialization method for strings or other blobs with variable size is to serialize first the size as you serialize integers, then just copy the content to the output stream.</p>
</blockquote>
<blockquote>
<p>When reading you first read the size, then allocate the string and then fill it by reading the correct number of bytes from the stream.</p>
</blockquote>
<h3 id="with-ostream-istream"><a href="#with-ostream-istream" class="headerlink" title="with ostream&#x2F;istream"></a>with ostream&#x2F;istream</h3><p>native way with ostream&#x2F;istream for example class <code>MyClass</code> with <code>height,width,name</code> fields.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">int</span> height;</span><br><span class="line">   <span class="type">int</span> width;</span><br><span class="line">   std::string name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">std::ostream&amp; <span class="title">MyClass::serialize</span><span class="params">(std::ostream &amp;out)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    out &lt;&lt; height;</span><br><span class="line">    out &lt;&lt; <span class="string">&#x27;,&#x27;</span> <span class="comment">//number seperator</span></span><br><span class="line">    out &lt;&lt; width;</span><br><span class="line">    out &lt;&lt; <span class="string">&#x27;,&#x27;</span> <span class="comment">//number seperator</span></span><br><span class="line">    out &lt;&lt; name.<span class="built_in">size</span>(); <span class="comment">//serialize size of string</span></span><br><span class="line">    out &lt;&lt; <span class="string">&#x27;,&#x27;</span> <span class="comment">//number seperator</span></span><br><span class="line">    out &lt;&lt; name; <span class="comment">//serialize characters of string</span></span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">std::istream&amp; <span class="title">MyClass::deserialize</span><span class="params">(std::istream &amp;in)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (in) &#123;</span><br><span class="line">        <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> comma;</span><br><span class="line">        in &gt;&gt; height;</span><br><span class="line">        in &gt;&gt; comma; <span class="comment">//read in the seperator</span></span><br><span class="line">        in &gt;&gt; width;</span><br><span class="line">        in &gt;&gt; comma; <span class="comment">//read in the seperator</span></span><br><span class="line">        in &gt;&gt; len;  <span class="comment">//deserialize size of string</span></span><br><span class="line">        in &gt;&gt; comma; <span class="comment">//read in the seperator</span></span><br><span class="line">        <span class="keyword">if</span> (in &amp;&amp; len) &#123;</span><br><span class="line">            <span class="function">std::vector&lt;<span class="type">char</span>&gt; <span class="title">tmp</span><span class="params">(len)</span></span>;</span><br><span class="line">            in.<span class="built_in">read</span>(tmp.<span class="built_in">data</span>() , len); <span class="comment">//deserialize characters of string</span></span><br><span class="line">            name.<span class="built_in">assign</span>(tmp.<span class="built_in">data</span>(), len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>overload for <code>operator&lt;&lt;</code> and <code>operator&gt;&gt;</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; out, <span class="type">const</span> MyClass &amp;obj)</span><br><span class="line">&#123;</span><br><span class="line">    obj.<span class="built_in">serialize</span>(out); </span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::istream&amp; <span class="keyword">operator</span>&gt;&gt;(std::istream&amp; in, MyClass &amp;obj)</span><br><span class="line">&#123;</span><br><span class="line">    obj.<span class="built_in">deserialize</span>(in); </span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h3 id="with-boost-serialization"><a href="#with-boost-serialization" class="headerlink" title="with boost serialization"></a>with boost serialization</h3><p>archive file format</p>
<ul>
<li>text: text_iarchive,text_oarchive <code>field</code></li>
<li>xml: xml_iarchive,xml_oarchive, with <code>BOOST_SERIALIZATION_NVP(field)</code></li>
<li>binary: binary_iarchive,binary_oarchive with <code>stringstream</code> or <code>fstream</code>.</li>
</ul>
<h4 id="text-archive"><a href="#text-archive" class="headerlink" title="text archive"></a>text archive</h4><p>change <code>BOOST_SERIALIZATION_NVP(field)</code> to <code>field</code></p>
<h4 id="xml-archive"><a href="#xml-archive" class="headerlink" title="xml archive"></a>xml archive</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/archive/text_iarchive.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/archive/text_oarchive.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/archive/xml_iarchive.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/archive/xml_oarchive.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/archive/binary_iarchive.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/archive/binary_oarchive.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Camera</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">int</span> id;</span><br><span class="line">	std::string name;</span><br><span class="line">	<span class="type">double</span> pos;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> boost &#123;</span><br><span class="line">	<span class="keyword">namespace</span> serialization &#123;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Archive&gt;</span></span><br><span class="line"><span class="function">		<span class="type">void</span> <span class="title">serialize</span><span class="params">(Archive&amp; archive, Camera&amp; cam, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">int</span> version)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam.id)</span></span>;</span><br><span class="line">			<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam.name)</span></span>;</span><br><span class="line">			<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam.pos)</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125; <span class="comment">// namespace serialization</span></span><br><span class="line">&#125; <span class="comment">// namespace boost</span></span><br><span class="line"></span><br><span class="line">std::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(std::ostream&amp; cout, <span class="type">const</span> Camera&amp; cam)</span><br><span class="line">&#123;</span><br><span class="line">	cout &lt;&lt; cam.id &lt;&lt; std::endl</span><br><span class="line">		&lt;&lt; cam.name &lt;&lt; std::endl</span><br><span class="line">		&lt;&lt; cam.pos &lt;&lt; std::endl;</span><br><span class="line">	<span class="keyword">return</span> cout;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">save</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">std::ofstream <span class="title">file</span><span class="params">(<span class="string">&quot;archive.xml&quot;</span>)</span></span>;</span><br><span class="line">	boost::<span class="function">archive::xml_oarchive <span class="title">oa</span><span class="params">(file)</span></span>;</span><br><span class="line">	</span><br><span class="line">	Camera cam;</span><br><span class="line">	cam.id = <span class="number">100</span>;</span><br><span class="line">	cam.name = <span class="string">&quot;new camera&quot;</span>;</span><br><span class="line">	cam.pos = <span class="number">99.88</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">oa &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">load</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">std::ifstream <span class="title">file</span><span class="params">(<span class="string">&quot;archive.xml&quot;</span>)</span></span>;</span><br><span class="line">	boost::<span class="function">archive::xml_iarchive <span class="title">ia</span><span class="params">(file)</span></span>;</span><br><span class="line">	Camera cam;</span><br><span class="line">	<span class="function">ia &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam)</span></span>;</span><br><span class="line">	std::cout &lt;&lt; cam &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_camera</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">save</span>();</span><br><span class="line">	<span class="built_in">load</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">test_camera</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="binary-archive"><a href="#binary-archive" class="headerlink" title="binary archive"></a>binary archive</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">save_load_with_binary_archive</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// binary archive with stringstream</span></span><br><span class="line">	std::ostringstream oss;</span><br><span class="line">	boost::<span class="function">archive::binary_oarchive <span class="title">oa</span><span class="params">(oss)</span></span>;</span><br><span class="line"></span><br><span class="line">	Camera cam;</span><br><span class="line">	cam.id = <span class="number">100</span>;</span><br><span class="line">	cam.name = <span class="string">&quot;new camera&quot;</span>;</span><br><span class="line">	cam.pos = <span class="number">99.88</span>;</span><br><span class="line"></span><br><span class="line">	oa &amp; (cam);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get binary content</span></span><br><span class="line">	std::string str_data = oss.<span class="built_in">str</span>();</span><br><span class="line">	<span class="function">std::istringstream <span class="title">iss</span><span class="params">(str_data)</span></span>;</span><br><span class="line">	boost::<span class="function">archive::binary_iarchive <span class="title">ia</span><span class="params">(iss)</span></span>;</span><br><span class="line">	Camera new_cam;</span><br><span class="line">	ia &amp; (new_cam);</span><br><span class="line">	std::cout &lt;&lt; new_cam &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h4 id="binary-archive-with-poco-SocketStream"><a href="#binary-archive-with-poco-SocketStream" class="headerlink" title="binary archive with poco SocketStream"></a>binary archive with poco SocketStream</h4><p>client.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">test_client</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">SocketAddress <span class="title">address</span><span class="params">(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">9911</span>)</span></span>;</span><br><span class="line">	<span class="function">StreamSocket <span class="title">socket</span><span class="params">(address)</span></span>;</span><br><span class="line">	<span class="function">SocketStream <span class="title">stream</span><span class="params">(socket)</span></span>;</span><br><span class="line">	<span class="comment">//Poco::StreamCopier::copyStream(stream, std::cout);</span></span><br><span class="line"></span><br><span class="line">	boost::<span class="function">archive::binary_oarchive <span class="title">oa</span><span class="params">(stream)</span></span>;</span><br><span class="line">	Camera cam;</span><br><span class="line">	cam.id = <span class="number">100</span>;</span><br><span class="line">	cam.name = <span class="string">&quot;new camera&quot;</span>;</span><br><span class="line">	cam.pos = <span class="number">99.88</span>;</span><br><span class="line"></span><br><span class="line">	oa &amp; (cam);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>server.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Application&amp; app = Application::<span class="built_in">instance</span>();</span><br><span class="line">		app.<span class="built_in">logger</span>().<span class="built_in">information</span>(<span class="string">&quot;Request from &quot;</span> + <span class="keyword">this</span>-&gt;<span class="built_in">socket</span>().<span class="built_in">peerAddress</span>().<span class="built_in">toString</span>());</span><br><span class="line">		<span class="keyword">try</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="function">SocketStream <span class="title">stream</span><span class="params">(<span class="keyword">this</span>-&gt;socket())</span></span>;</span><br><span class="line">			<span class="comment">//Poco::StreamCopier::copyStream(stream, std::cout);</span></span><br><span class="line"></span><br><span class="line">			boost::<span class="function">archive::binary_iarchive <span class="title">ia</span><span class="params">(stream)</span></span>;</span><br><span class="line">			Camera new_cam;</span><br><span class="line">			ia &amp; (new_cam);</span><br><span class="line">			std::cout &lt;&lt; new_cam &lt;&lt; std::endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">catch</span> (Poco::Exception&amp; exc)</span><br><span class="line">		&#123;</span><br><span class="line">			app.<span class="built_in">logger</span>().<span class="built_in">log</span>(exc);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="notes-on-std-string"><a href="#notes-on-std-string" class="headerlink" title="notes on std::string"></a>notes on std::string</h4><p>Even know you have seen that they do the same, or that <code>.data()</code> calls <code>.c_str()</code>, it is not correct to assume that this will be the case for other compilers. It is also possible that your compiler will change with a future release.</p>
<p>2 reasons to use <code>std::string</code>:</p>
<p><code>std::string</code> can be used for both <code>text</code> and <code>arbitrary binary data</code>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Example 1</span></span><br><span class="line"><span class="comment">//Plain text:</span></span><br><span class="line">std::string s1;</span><br><span class="line">s1 = <span class="string">&quot;abc&quot;</span>;</span><br><span class="line">s<span class="number">1.</span><span class="built_in">c_str</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Example 2</span></span><br><span class="line"><span class="comment">//Arbitrary binary data:</span></span><br><span class="line">std::string s2;</span><br><span class="line">s<span class="number">2.</span><span class="built_in">append</span>(<span class="string">&quot;a\0b\0b\0&quot;</span>, <span class="number">6</span>);</span><br><span class="line">s<span class="number">2.</span><span class="built_in">data</span>();</span><br></pre></td></tr></table></figure>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h3 id="boost-archive-style"><a href="#boost-archive-style" class="headerlink" title="boost archive style"></a>boost archive style</h3><h4 id="intrusive"><a href="#intrusive" class="headerlink" title="intrusive"></a>intrusive</h4><ul>
<li><code>private template&lt;class Archive&gt;   void serialize(Archive&amp; archive, const unsigned int version)</code></li>
<li><code>friend class boost::serialization::access;</code></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Camera</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">int</span> id;</span><br><span class="line">	std::string name;</span><br><span class="line">	<span class="type">double</span> pos;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">class</span> <span class="title class_">boost</span>::serialization::access;</span><br><span class="line">	<span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Archive&gt;</span></span><br><span class="line"><span class="function">	<span class="type">void</span> <span class="title">serialize</span><span class="params">(Archive&amp; archive, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">int</span> version)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(id)</span></span>;</span><br><span class="line">		<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(name)</span></span>;</span><br><span class="line">		<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(pos)</span></span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="non-intrusive"><a href="#non-intrusive" class="headerlink" title="non-intrusive"></a>non-intrusive</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Camera</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">int</span> id;</span><br><span class="line">	std::string name;</span><br><span class="line">	<span class="type">double</span> pos;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> boost &#123;</span><br><span class="line">	<span class="keyword">namespace</span> serialization &#123;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Archive&gt;</span></span><br><span class="line"><span class="function">		<span class="type">void</span> <span class="title">serialize</span><span class="params">(Archive&amp; archive, Camera&amp; cam, <span class="type">const</span> <span class="type">unsigned</span> <span class="type">int</span> version)</span></span></span><br><span class="line"><span class="function">		</span>&#123;</span><br><span class="line">			<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam.id)</span></span>;</span><br><span class="line">			<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam.name)</span></span>;</span><br><span class="line">			<span class="function">archive &amp; <span class="title">BOOST_SERIALIZATION_NVP</span><span class="params">(cam.pos)</span></span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125; <span class="comment">// namespace serialization</span></span><br><span class="line">&#125; <span class="comment">// namespace boost</span></span><br></pre></td></tr></table></figure>

<h3 id="boost-archive-type"><a href="#boost-archive-type" class="headerlink" title="boost archive type"></a>boost archive type</h3><h4 id="shared-ptr"><a href="#shared-ptr" class="headerlink" title="shared_ptr"></a>shared_ptr</h4><p><code>boost::shared_ptr&lt;T&gt;</code> instead of <code>std::shared_prt&lt;T&gt;</code><br>and </p>
<pre><code>#include &lt;boost/serialization/shared_ptr.hpp&gt;
</code></pre>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/7046244/serializing-a-class-which-contains-a-stdstring">serializing-a-class-which-contains-a-stdstring</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/234724/is-it-possible-to-serialize-and-deserialize-a-class-in-c">is-it-possible-to-serialize-and-deserialize-a-class-in-c</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/234724/is-it-possible-to-serialize-and-deserialize-a-class-in-c">boost serialization</a></li>
<li><a target="_blank" rel="noopener" href="http://www.boost.org/doc/libs/1_36_0/libs/serialization/example/demo.cpp">boost serialization demo</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/aix/library/au-boostserialization/">ibm boostserialization</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6815039/fast-data-image-transfer-server-client-using-boost-asio">fast-data-image-transfer-server-client-using-boost-asio</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180128: created.</li>
<li>20180129: add intrusive,non-intrusive part.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/compile-and-install-poco-cpp-library-on-windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/compile-and-install-poco-cpp-library-on-windows/" class="post-title-link" itemprop="url">how to compile and install poco cpp library on windows</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-01-25 01:53:00" itemprop="dateCreated datePublished" datetime="2018-01-25T01:53:00+08:00">2018-01-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><ul>
<li><strong><a href="https://kezunlin.me/post/9587bb47/">how to compile and install poco cpp library on windows</a></strong></li>
<li><a href="https://kezunlin.me/post/281dd8cd/">how to compile and install poco cpp library on ubuntu 16.04</a></li>
</ul>
<h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="download"><a href="#download" class="headerlink" title="download"></a>download</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://pocoproject.org/releases/poco-1.8.1/poco-1.8.1.zip</span><br><span class="line">wget https://pocoproject.org/releases/poco-1.8.1/poco-1.8.1.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="build"><a href="#build" class="headerlink" title="build"></a>build</h3><h4 id="build-options"><a href="#build-options" class="headerlink" title="build options"></a>build options</h4><p>buildwin.cmd</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">rem Usage:</span></span><br><span class="line"><span class="comment">rem ------</span></span><br><span class="line"><span class="comment">rem buildwin VS_VERSION [ACTION] [LINKMODE] [CONFIGURATION] [PLATFORM] [SAMPLES] [TESTS] [TOOL]</span></span><br><span class="line"><span class="comment">rem VS_VERSION:    90|100|110|120|140|150</span></span><br><span class="line"><span class="comment">rem ACTION:        build|rebuild|clean</span></span><br><span class="line"><span class="comment">rem LINKMODE:      static_mt|static_md|shared|all</span></span><br><span class="line"><span class="comment">rem CONFIGURATION: release|debug|both</span></span><br><span class="line"><span class="comment">rem PLATFORM:      Win32|x64|WinCE|WEC2013</span></span><br><span class="line"><span class="comment">rem SAMPLES:       samples|nosamples</span></span><br><span class="line"><span class="comment">rem TESTS:         tests|notests</span></span><br><span class="line"><span class="comment">rem TOOL:          devenv|vcexpress|wdexpress|msbuild</span></span><br></pre></td></tr></table></figure>

<p>we choose to build with <code>visual studio 2015</code></p>
<p>build_vs140.cmd</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">buildwin <span class="number">140</span> build shared release x64 samples</span><br></pre></td></tr></table></figure>

<h4 id="build-1"><a href="#build-1" class="headerlink" title="build"></a>build</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./build_vs140.cmd</span><br></pre></td></tr></table></figure>

<p>or </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake-gui ..</span><br></pre></td></tr></table></figure>

<p><code>cmake-gui</code> and open <code>sln</code> to build with <code>release x64</code>and install to <code>C:/Program Files/Poco</code> so that <code>find_package(Poco REQURIED)</code> take effect.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> Poco</span><br><span class="line"></span><br><span class="line">bin  include  lib</span><br><span class="line"></span><br><span class="line">$ ll Poco/lib</span><br><span class="line"></span><br><span class="line">total 3.5M</span><br><span class="line">drwxr-xr-x 1 zunli zunli     0 Jan 25 07:39 cmake</span><br><span class="line">-rw-r--r-- 1 zunli zunli  1.5M Jan 25 06:59 PocoFoundation.lib</span><br><span class="line">-rw-r--r-- 1 zunli zunli  111K Jan 25 06:59 PocoJSON.lib</span><br><span class="line">-rw-r--r-- 1 zunli zunli 1007K Jan 25 07:00 PocoNet.lib</span><br><span class="line">-rw-r--r-- 1 zunli zunli  320K Jan 25 07:00 PocoUtil.lib</span><br><span class="line">-rw-r--r-- 1 zunli zunli  595K Jan 25 07:00 PocoXML.lib</span><br></pre></td></tr></table></figure>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>



<h2 id="Poco-Example"><a href="#Poco-Example" class="headerlink" title="Poco Example"></a>Poco Example</h2><h3 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span> (VERSION <span class="number">2.6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">project</span> (event_demo)</span><br><span class="line"><span class="keyword">enable_language</span>(C)</span><br><span class="line"><span class="keyword">enable_language</span>(CXX)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Always include the source and build directories in the include path.</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_INCLUDE_CURRENT_DIR <span class="keyword">ON</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the output folder where your program will be created</span></span><br><span class="line"><span class="keyword">set</span>(CMAKE_BINARY_DIR <span class="variable">$&#123;CMAKE_SOURCE_DIR&#125;</span>/bin)</span><br><span class="line"><span class="keyword">set</span>(EXECUTABLE_OUTPUT_PATH <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>)</span><br><span class="line"><span class="keyword">set</span>(LIBRARY_OUTPUT_PATH <span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(Poco REQUIRED COMPONENTS Foundation Util Net XML JSON)</span><br><span class="line"></span><br><span class="line"><span class="comment"># no Poco_INCLUDE_DIRS, we have to set by hand </span></span><br><span class="line"><span class="keyword">if</span>(MSVC) <span class="comment"># WIN32</span></span><br><span class="line">	<span class="keyword">SET</span>(Poco_INCLUDE_DIRS <span class="string">&quot;C:/Program Files/Poco/include&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">	<span class="keyword">SET</span>(Poco_INCLUDE_DIRS <span class="string">&quot;/usr/local/include/Poco&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>(MSVC)</span><br><span class="line"></span><br><span class="line"><span class="keyword">MESSAGE</span>( [Main] <span class="string">&quot; Poco_INCLUDE_DIRS = $&#123;Poco_INCLUDE_DIRS&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">MESSAGE</span>( [Main] <span class="string">&quot; Poco_LIBRARIES = $&#123;Poco_LIBRARIES&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The following folder will be included</span></span><br><span class="line"><span class="keyword">include_directories</span>(</span><br><span class="line">    <span class="variable">$&#123;MY_SRC_INCLUDE&#125;</span>  </span><br><span class="line">	<span class="variable">$&#123;Poco_INCLUDE_DIRS&#125;</span> </span><br><span class="line">    )   </span><br><span class="line"></span><br><span class="line"><span class="keyword">link_directories</span>(<span class="variable">$&#123;CMAKE_BINARY_DIR&#125;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(event_demo event_demo.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(event_demo <span class="variable">$&#123;Poco_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Notice 1: <code>find_package(Poco REQUIRED COMPONENTS Foundation Util Net XML JSON)</code> and use <code>$&#123;Poco_INCLUDE_DIRS&#125;</code>, <code>$&#123;Poco_LIBRARIES&#125;</code>.</p>
</blockquote>
<blockquote>
<p>Notice 2: we have to set <code>SET(Poco_INCLUDE_DIRS &quot;C:/Program Files/Poco/include&quot;)</code> by hand.</p>
</blockquote>
<h3 id="event"><a href="#event" class="headerlink" title="event"></a>event</h3><h4 id="event-demo-cpp"><a href="#event-demo-cpp" class="headerlink" title="event_demo.cpp"></a>event_demo.cpp</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/BasicEvent.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Delegate.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Poco::BasicEvent;</span><br><span class="line"><span class="keyword">using</span> Poco::Delegate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Source</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    BasicEvent&lt;<span class="type">int</span>&gt; theEvent;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">fireEvent</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">theEvent</span>(<span class="keyword">this</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Target</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">onEvent</span><span class="params">(<span class="type">const</span> <span class="type">void</span>* pSender, <span class="type">int</span>&amp; arg)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;onEvent: &quot;</span> &lt;&lt; arg &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Source source;</span><br><span class="line">    Target target;</span><br><span class="line"></span><br><span class="line">    source.theEvent += <span class="built_in">Delegate</span>&lt;Target, <span class="type">int</span>&gt;(</span><br><span class="line">        &amp;target, &amp;Target::onEvent);</span><br><span class="line"></span><br><span class="line">    source.<span class="built_in">fireEvent</span>(<span class="number">42</span>);</span><br><span class="line"></span><br><span class="line">    source.theEvent -= <span class="built_in">Delegate</span>&lt;Target, <span class="type">int</span>&gt;(</span><br><span class="line">        &amp;target, &amp;Target::onEvent);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="active-method"><a href="#active-method" class="headerlink" title="active method"></a>active method</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/ActiveMethod.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/ActiveResult.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Poco::ActiveMethod;</span><br><span class="line"><span class="keyword">using</span> Poco::ActiveResult;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ActiveAdder</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">ActiveAdder</span>() : <span class="built_in">add</span>(<span class="keyword">this</span>, &amp;ActiveAdder::addImpl)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	ActiveMethod&lt;<span class="type">int</span>, std::pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, ActiveAdder&gt; add;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">addImpl</span><span class="params">(<span class="type">const</span> std::pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&amp; args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> args.first + args.second;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ActiveAdder adder;</span><br><span class="line"></span><br><span class="line">	ActiveResult&lt;<span class="type">int</span>&gt; sum = adder.<span class="built_in">add</span>(std::<span class="built_in">make_pair</span>(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">	<span class="comment">// do other things</span></span><br><span class="line">	sum.<span class="built_in">wait</span>();</span><br><span class="line">	std::cout &lt;&lt; sum.<span class="built_in">data</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="http-server"><a href="#http-server" class="headerlink" title="http server"></a>http server</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPServer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPRequestHandler.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPRequestHandlerFactory.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPServerParams.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPServerRequest.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPServerResponse.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/HTTPServerParams.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/ServerSocket.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Timestamp.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/DateTimeFormatter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/DateTimeFormat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Exception.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/ThreadPool.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/ServerApplication.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/Option.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/OptionSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/HelpFormatter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Poco::Net::ServerSocket;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::HTTPRequestHandler;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::HTTPRequestHandlerFactory;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::HTTPServer;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::HTTPServerRequest;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::HTTPServerResponse;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::HTTPServerParams;</span><br><span class="line"><span class="keyword">using</span> Poco::Timestamp;</span><br><span class="line"><span class="keyword">using</span> Poco::DateTimeFormatter;</span><br><span class="line"><span class="keyword">using</span> Poco::DateTimeFormat;</span><br><span class="line"><span class="keyword">using</span> Poco::ThreadPool;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::ServerApplication;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::Application;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::Option;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::OptionSet;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::OptionCallback;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::HelpFormatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeRequestHandler</span> : <span class="keyword">public</span> HTTPRequestHandler</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">TimeRequestHandler</span>(<span class="type">const</span> std::string&amp; format) : _format(format)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">handleRequest</span><span class="params">(HTTPServerRequest&amp; request,</span></span></span><br><span class="line"><span class="params"><span class="function">		HTTPServerResponse&amp; response)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Application&amp; app = Application::<span class="built_in">instance</span>();</span><br><span class="line">		app.<span class="built_in">logger</span>().<span class="built_in">information</span>(<span class="string">&quot;[LOG] Request from &quot;</span></span><br><span class="line">			+ request.<span class="built_in">clientAddress</span>().<span class="built_in">toString</span>());</span><br><span class="line"></span><br><span class="line">		Timestamp now;</span><br><span class="line">		<span class="function">std::string <span class="title">dt</span><span class="params">(DateTimeFormatter::format(now, _format))</span></span>;</span><br><span class="line"></span><br><span class="line">		response.<span class="built_in">setChunkedTransferEncoding</span>(<span class="literal">true</span>);</span><br><span class="line">		response.<span class="built_in">setContentType</span>(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line"></span><br><span class="line">		std::ostream&amp; ostr = response.<span class="built_in">send</span>();</span><br><span class="line">		ostr &lt;&lt; <span class="string">&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;HTTPTimeServer powered by &quot;</span></span><br><span class="line">			<span class="string">&quot;POCO C++ Libraries&lt;/title&gt;&quot;</span>;</span><br><span class="line">		ostr &lt;&lt; <span class="string">&quot;&lt;meta http-equiv=\&quot;refresh\&quot; content=\&quot;1\&quot;&gt;&lt;/head&gt;&quot;</span>;</span><br><span class="line">		ostr &lt;&lt; <span class="string">&quot;&lt;body&gt;&lt;p style=\&quot;text-align: center; &quot;</span></span><br><span class="line">			<span class="string">&quot;font-size: 48px;\&quot;&gt;&quot;</span>;</span><br><span class="line">		ostr &lt;&lt; dt;</span><br><span class="line">		ostr &lt;&lt; <span class="string">&quot;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	std::string _format;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeRequestHandlerFactory</span> : <span class="keyword">public</span> HTTPRequestHandlerFactory</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">TimeRequestHandlerFactory</span>(<span class="type">const</span> std::string&amp; format) :</span><br><span class="line">		_format(format)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">HTTPRequestHandler* <span class="title">createRequestHandler</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="type">const</span> HTTPServerRequest&amp; request)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (request.<span class="built_in">getURI</span>() == <span class="string">&quot;/&quot;</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">TimeRequestHandler</span>(_format);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	std::string _format;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HTTPTimeServer</span> : <span class="keyword">public</span> Poco::Util::ServerApplication</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">HTTPTimeServer</span>() : _helpRequested(<span class="literal">false</span>)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">HTTPTimeServer</span>()</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">initialize</span><span class="params">(Application&amp; self)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Application&amp; app = Application::<span class="built_in">instance</span>();</span><br><span class="line">		app.<span class="built_in">logger</span>().<span class="built_in">information</span>(<span class="string">&quot;[HTTPTimeServer] initialize port=9980 &quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="built_in">loadConfiguration</span>();</span><br><span class="line">		ServerApplication::<span class="built_in">initialize</span>(self);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">uninitialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Application&amp; app = Application::<span class="built_in">instance</span>();</span><br><span class="line">		app.<span class="built_in">logger</span>().<span class="built_in">information</span>(<span class="string">&quot;[HTTPTimeServer] uninitialize &quot;</span>);</span><br><span class="line"></span><br><span class="line">		ServerApplication::<span class="built_in">uninitialize</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">defineOptions</span><span class="params">(OptionSet&amp; options)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		ServerApplication::<span class="built_in">defineOptions</span>(options);</span><br><span class="line"></span><br><span class="line">		options.<span class="built_in">addOption</span>(</span><br><span class="line">			<span class="built_in">Option</span>(<span class="string">&quot;help&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;display argument help information&quot;</span>)</span><br><span class="line">			.<span class="built_in">required</span>(<span class="literal">false</span>)</span><br><span class="line">			.<span class="built_in">repeatable</span>(<span class="literal">false</span>)</span><br><span class="line">			.<span class="built_in">callback</span>(<span class="built_in">OptionCallback</span>&lt;HTTPTimeServer&gt;(</span><br><span class="line">				<span class="keyword">this</span>, &amp;HTTPTimeServer::handleHelp)));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">handleHelp</span><span class="params">(<span class="type">const</span> std::string&amp; name,</span></span></span><br><span class="line"><span class="params"><span class="function">		<span class="type">const</span> std::string&amp; value)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="function">HelpFormatter <span class="title">helpFormatter</span><span class="params">(options())</span></span>;</span><br><span class="line">		helpFormatter.<span class="built_in">setCommand</span>(<span class="built_in">commandName</span>());</span><br><span class="line">		helpFormatter.<span class="built_in">setUsage</span>(<span class="string">&quot;OPTIONS&quot;</span>);</span><br><span class="line">		helpFormatter.<span class="built_in">setHeader</span>(</span><br><span class="line">			<span class="string">&quot;A web server that serves the current date and time.&quot;</span>);</span><br><span class="line">		helpFormatter.format(std::cout);</span><br><span class="line">		<span class="built_in">stopOptionsProcessing</span>();</span><br><span class="line">		_helpRequested = <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">const</span> std::vector&lt;std::string&gt;&amp; args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Application&amp; app = Application::<span class="built_in">instance</span>();</span><br><span class="line">		app.<span class="built_in">logger</span>().<span class="built_in">information</span>(<span class="string">&quot;[HTTPTimeServer] main &quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (!_helpRequested)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> port = (<span class="type">unsigned</span> <span class="type">short</span>)</span><br><span class="line">				<span class="built_in">config</span>().<span class="built_in">getInt</span>(<span class="string">&quot;HTTPTimeServer.port&quot;</span>, <span class="number">9980</span>);</span><br><span class="line">			<span class="function">std::string <span class="title">format</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">				config().getString(<span class="string">&quot;HTTPTimeServer.format&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">					DateTimeFormat::SORTABLE_FORMAT))</span></span>;</span><br><span class="line"></span><br><span class="line">			<span class="function">ServerSocket <span class="title">svs</span><span class="params">(port)</span></span>;</span><br><span class="line">			<span class="function">HTTPServer <span class="title">srv</span><span class="params">(<span class="keyword">new</span> TimeRequestHandlerFactory(format),</span></span></span><br><span class="line"><span class="params"><span class="function">				svs, <span class="keyword">new</span> HTTPServerParams)</span></span>;</span><br><span class="line">			srv.<span class="built_in">start</span>();</span><br><span class="line">			<span class="built_in">waitForTerminationRequest</span>();</span><br><span class="line">			srv.<span class="built_in">stop</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Application::EXIT_OK;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">bool</span> _helpRequested;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HTTPTimeServer app;</span><br><span class="line">	<span class="keyword">return</span> app.<span class="built_in">run</span>(argc, argv);</span><br><span class="line">	<span class="comment">//visit http://localhost:9980</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="tcp-server-client"><a href="#tcp-server-client" class="headerlink" title="tcp server&#x2F;client"></a>tcp server&#x2F;client</h3><h4 id="tcpserver"><a href="#tcpserver" class="headerlink" title="tcpserver"></a>tcpserver</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// TimeServer.cpp</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// This sample demonstrates the TCPServer and ServerSocket classes.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Copyright (c) 2005-2006, Applied Informatics Software Engineering GmbH.</span></span><br><span class="line"><span class="comment">// and Contributors.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// SPDX-License-Identifier:	BSL-1.0</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/TCPServer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/TCPServerConnection.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/TCPServerConnectionFactory.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/TCPServerParams.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/StreamSocket.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/ServerSocket.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Timestamp.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/DateTimeFormatter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/DateTimeFormat.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Exception.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/ServerApplication.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/Option.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/OptionSet.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Util/HelpFormatter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Poco::Net::ServerSocket;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::StreamSocket;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::TCPServerConnection;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::TCPServerConnectionFactory;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::TCPServer;</span><br><span class="line"><span class="keyword">using</span> Poco::Timestamp;</span><br><span class="line"><span class="keyword">using</span> Poco::DateTimeFormatter;</span><br><span class="line"><span class="keyword">using</span> Poco::DateTimeFormat;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::ServerApplication;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::Application;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::Option;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::OptionSet;</span><br><span class="line"><span class="keyword">using</span> Poco::Util::HelpFormatter;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeServerConnection</span> : <span class="keyword">public</span> TCPServerConnection</span><br><span class="line">	<span class="comment">/// This class handles all client connections.</span></span><br><span class="line">	<span class="comment">///</span></span><br><span class="line">	<span class="comment">/// A string with the current date and time is sent back to the client.</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">TimeServerConnection</span>(<span class="type">const</span> StreamSocket&amp; s, <span class="type">const</span> std::string&amp; format) :</span><br><span class="line">		<span class="built_in">TCPServerConnection</span>(s),</span><br><span class="line">		_format(format)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Application&amp; app = Application::<span class="built_in">instance</span>();</span><br><span class="line">		app.<span class="built_in">logger</span>().<span class="built_in">information</span>(<span class="string">&quot;Request from &quot;</span> + <span class="keyword">this</span>-&gt;<span class="built_in">socket</span>().<span class="built_in">peerAddress</span>().<span class="built_in">toString</span>());</span><br><span class="line">		<span class="keyword">try</span></span><br><span class="line">		&#123;</span><br><span class="line">			Timestamp now;</span><br><span class="line">			<span class="comment">//std::string dt(DateTimeFormatter::format(now, _format));</span></span><br><span class="line">			<span class="comment">//dt.append(&quot;\r\n&quot;);</span></span><br><span class="line">			<span class="function">std::string <span class="title">dt</span><span class="params">(<span class="string">&quot;hello world&quot;</span>)</span></span>;</span><br><span class="line">			<span class="function">std::string <span class="title">info</span><span class="params">(<span class="string">&quot;sending:  [&quot;</span> + dt + <span class="string">&quot;] with length=&quot;</span>+std::to_string(dt.length()) )</span></span>;</span><br><span class="line">			app.<span class="built_in">logger</span>().<span class="built_in">information</span>(info);</span><br><span class="line">			<span class="built_in">socket</span>().<span class="built_in">sendBytes</span>(dt.<span class="built_in">data</span>(), (<span class="type">int</span>)dt.<span class="built_in">length</span>());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">catch</span> (Poco::Exception&amp; exc)</span><br><span class="line">		&#123;</span><br><span class="line">			app.<span class="built_in">logger</span>().<span class="built_in">log</span>(exc);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	std::string _format;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeServerConnectionFactory</span> : <span class="keyword">public</span> TCPServerConnectionFactory</span><br><span class="line">	<span class="comment">/// A factory for TimeServerConnection.</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">TimeServerConnectionFactory</span>(<span class="type">const</span> std::string&amp; format) :</span><br><span class="line">		_format(format)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">TCPServerConnection* <span class="title">createConnection</span><span class="params">(<span class="type">const</span> StreamSocket&amp; socket)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">TimeServerConnection</span>(socket, _format);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	std::string _format;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeServer</span> : <span class="keyword">public</span> Poco::Util::ServerApplication</span><br><span class="line">	<span class="comment">/// The main application class.</span></span><br><span class="line">	<span class="comment">///</span></span><br><span class="line">	<span class="comment">/// This class handles command-line arguments and</span></span><br><span class="line">	<span class="comment">/// configuration files.</span></span><br><span class="line">	<span class="comment">/// Start the TimeServer executable with the help</span></span><br><span class="line">	<span class="comment">/// option (/help on Windows, --help on Unix) for</span></span><br><span class="line">	<span class="comment">/// the available command line options.</span></span><br><span class="line">	<span class="comment">///</span></span><br><span class="line">	<span class="comment">/// To use the sample configuration file (TimeServer.properties),</span></span><br><span class="line">	<span class="comment">/// copy the file to the directory where the TimeServer executable</span></span><br><span class="line">	<span class="comment">/// resides. If you start the debug version of the TimeServer</span></span><br><span class="line">	<span class="comment">/// (TimeServerd[.exe]), you must also create a copy of the configuration</span></span><br><span class="line">	<span class="comment">/// file named TimeServerd.properties. In the configuration file, you</span></span><br><span class="line">	<span class="comment">/// can specify the port on which the server is listening (default</span></span><br><span class="line">	<span class="comment">/// 9911) and the format of the date/time string sent back to the client.</span></span><br><span class="line">	<span class="comment">///</span></span><br><span class="line">	<span class="comment">/// To test the TimeServer you can use any telnet client (telnet localhost 9911).</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">TimeServer</span>() : _helpRequested(<span class="literal">false</span>)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">TimeServer</span>()</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">initialize</span><span class="params">(Application&amp; self)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">loadConfiguration</span>(); <span class="comment">// load default configuration files, if present</span></span><br><span class="line">		ServerApplication::<span class="built_in">initialize</span>(self);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">uninitialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		ServerApplication::<span class="built_in">uninitialize</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">defineOptions</span><span class="params">(OptionSet&amp; options)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		ServerApplication::<span class="built_in">defineOptions</span>(options);</span><br><span class="line"></span><br><span class="line">		options.<span class="built_in">addOption</span>(</span><br><span class="line">			<span class="built_in">Option</span>(<span class="string">&quot;help&quot;</span>, <span class="string">&quot;h&quot;</span>, <span class="string">&quot;display help information on command line arguments&quot;</span>)</span><br><span class="line">			.<span class="built_in">required</span>(<span class="literal">false</span>)</span><br><span class="line">			.<span class="built_in">repeatable</span>(<span class="literal">false</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">handleOption</span><span class="params">(<span class="type">const</span> std::string&amp; name, <span class="type">const</span> std::string&amp; value)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		ServerApplication::<span class="built_in">handleOption</span>(name, value);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (name == <span class="string">&quot;help&quot;</span>)</span><br><span class="line">			_helpRequested = <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">displayHelp</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="function">HelpFormatter <span class="title">helpFormatter</span><span class="params">(options())</span></span>;</span><br><span class="line">		helpFormatter.<span class="built_in">setCommand</span>(<span class="built_in">commandName</span>());</span><br><span class="line">		helpFormatter.<span class="built_in">setUsage</span>(<span class="string">&quot;OPTIONS&quot;</span>);</span><br><span class="line">		helpFormatter.<span class="built_in">setHeader</span>(<span class="string">&quot;A server application that serves the current date and time.&quot;</span>);</span><br><span class="line">		helpFormatter.format(std::cout);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">const</span> std::vector&lt;std::string&gt;&amp; args)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (_helpRequested)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">displayHelp</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// get parameters from configuration file</span></span><br><span class="line">			<span class="type">unsigned</span> <span class="type">short</span> port = (<span class="type">unsigned</span> <span class="type">short</span>)<span class="built_in">config</span>().<span class="built_in">getInt</span>(<span class="string">&quot;TimeServer.port&quot;</span>, <span class="number">9911</span>);</span><br><span class="line">			<span class="function">std::string <span class="title">format</span><span class="params">(config().getString(<span class="string">&quot;TimeServer.format&quot;</span>, DateTimeFormat::ISO8601_FORMAT))</span></span>;</span><br><span class="line"></span><br><span class="line">			<span class="comment">// set-up a server socket</span></span><br><span class="line">			<span class="function">ServerSocket <span class="title">svs</span><span class="params">(port)</span></span>;</span><br><span class="line">			<span class="comment">// set-up a TCPServer instance</span></span><br><span class="line">			<span class="function">TCPServer <span class="title">srv</span><span class="params">(<span class="keyword">new</span> TimeServerConnectionFactory(format), svs)</span></span>;</span><br><span class="line">			<span class="comment">// start the TCPServer</span></span><br><span class="line">			srv.<span class="built_in">start</span>();</span><br><span class="line">			<span class="comment">// wait for CTRL-C or kill</span></span><br><span class="line">			<span class="built_in">waitForTerminationRequest</span>();</span><br><span class="line">			<span class="comment">// Stop the TCPServer</span></span><br><span class="line">			srv.<span class="built_in">stop</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> Application::EXIT_OK;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">bool</span> _helpRequested;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	TimeServer app; <span class="comment">// 9911</span></span><br><span class="line">	<span class="keyword">return</span> app.<span class="built_in">run</span>(argc, argv);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>start tcpserver.</p>
<h4 id="tcpclient"><a href="#tcpclient" class="headerlink" title="tcpclient"></a>tcpclient</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// TimeClient.cpp</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/SocketAddress.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Poco/Net/StreamSocket.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> Poco::Net::SocketAddress;</span><br><span class="line"><span class="keyword">using</span> Poco::Net::StreamSocket;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>** argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">SocketAddress <span class="title">sa</span><span class="params">(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">9911</span>)</span></span>;</span><br><span class="line">	<span class="function">StreamSocket <span class="title">ss</span><span class="params">(sa)</span></span>;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="type">char</span> buffer[<span class="number">256</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//n = 11 , s[0,1,2,....10] = hello world s[11]=&#x27;\0&#x27;</span></span><br><span class="line">	n = ss.<span class="built_in">receiveBytes</span>(buffer, <span class="built_in">sizeof</span>(buffer)<span class="number">-1</span>);</span><br><span class="line">	buffer[n] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	std::cout &lt;&lt; buffer &lt;&lt; std::endl;</span><br><span class="line">	std::cout &lt;&lt; n &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>start tcpclient to receive data from tcpserver.</p>
<h4 id="telnet-as-tcpclient"><a href="#telnet-as-tcpclient" class="headerlink" title="telnet as tcpclient"></a>telnet as tcpclient</h4><p>install <code>telnet</code> on windows by contron panel.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet localhost 9911</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://pocoproject.org/docs/99150-WindowsPlatformNotes.html">poco windows</a></li>
<li><a target="_blank" rel="noopener" href="https://pocoproject.org/docs/00100-GuidedTour.html">poco guide</a></li>
<li><a target="_blank" rel="noopener" href="https://pocoproject.org/slides/200-Network.pdf">poco newwork pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/pocoproject/poco/tree/develop/Net/samples">poco net samples</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20180125: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">kezunlin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">181</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">213</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kezunlin</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
