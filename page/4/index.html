<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-5653382914441020",
      enable_page_level_ads: true
    });
  </script>

  <meta name="google-site-verification" content="WSpJFvfcmIPBX_iK8uPbmCHIy_0f1lvd7ZJpbyad2sA">
  <meta name="yandex-verification" content="808eb057eb8396cc">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"kezunlin.me","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Kezunlin&#39;s Blog">
<meta property="og:url" content="https://kezunlin.me/page/4/index.html">
<meta property="og:site_name" content="Kezunlin&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="kezunlin">
<meta property="article:tag" content="linux, c++, python, AI, LLM">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://kezunlin.me/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Kezunlin's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Kezunlin's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Kezunlin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Live and Learn</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/cpp-macro-like-function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/cpp-macro-like-function/" class="post-title-link" itemprop="url">cpp macro like function to implement a performance profiler</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-10 15:24:00" itemprop="dateCreated datePublished" datetime="2019-10-10T15:24:00+08:00">2019-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="macro-expansions"><a href="#macro-expansions" class="headerlink" title="macro expansions"></a>macro expansions</h3><ul>
<li>#name &#x3D;&#x3D;&#x3D;&gt;  quote as strings  “xxx”</li>
<li>##name, name  &#x3D;&#x3D;&#x3D;&gt;  xxx</li>
<li>a ## b &#x3D;&#x3D;&#x3D;&gt;  concatenate the preceding and following tokens.</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// #name ===&gt;  &quot;xxx&quot;</span></span><br><span class="line"><span class="comment">// name,  ##name ===&gt; xxx</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ##name ===&gt; concatenate  </span></span><br><span class="line"><span class="comment">// #name ===&gt;  quote as strings</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a ## b ===&gt;  concatenate the preceding and following tokens.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> QUOTE(name) #name</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONCAT(x,y) x##y   <span class="comment">// x ## y   space in ommited</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MACRO(name)  #name <span class="string">&quot;foo&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MACRO2(name) name <span class="string">&quot;foo&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MACRO3(name) ##name <span class="string">&quot;foo&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CAT(a, ...) a ## __VA_ARGS__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IIF(c) CAT(IIF_, c)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IIF_0(t, ...) __VA_ARGS__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IIF_1(t, ...) t</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">macro_demo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">QUOTE</span>(test); <span class="comment">// &quot;test&quot;</span></span><br><span class="line">	<span class="built_in">CONCAT</span>(test, foo); <span class="comment">// testfoo</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">MACRO</span>(test); <span class="comment">// &quot;test&quot; &quot;foo&quot;</span></span><br><span class="line">	<span class="built_in">MACRO2</span>(test);<span class="comment">// test &quot;foo&quot;</span></span><br><span class="line">	<span class="built_in">MACRO3</span>(test);<span class="comment">// test &quot;foo&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="macro-function"><a href="#macro-function" class="headerlink" title="macro function"></a>macro function</h3><h4 id="define"><a href="#define" class="headerlink" title="define"></a>define</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SUM(a,b)  (a+b)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MYDEBUG(...)   fprintf(stderr, ##__VA_ARGS__)</span></span><br></pre></td></tr></table></figure>

<h4 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> c = <span class="built_in">SUM</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">MYDEBUG</span>(<span class="string">&quot;%d,%d \n&quot;</span>,<span class="number">1</span>,<span class="number">2</span>);     <span class="comment">/*   Becomes fprintf(stderr,&quot;%d,%d \n&quot;,1,2);   */</span></span><br></pre></td></tr></table></figure>

<h3 id="with-class-object"><a href="#with-class-object" class="headerlink" title="with class object"></a>with class object</h3><h4 id="define-1"><a href="#define-1" class="headerlink" title="define"></a>define</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">profiler</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">profiler</span>(<span class="type">const</span> <span class="type">char</span>* func_name, <span class="type">unsigned</span> <span class="type">int</span> times = <span class="number">1</span>);</span><br><span class="line">	~<span class="built_in">profiler</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">start</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	boost::posix_time::ptime pt1;</span><br><span class="line">	boost::posix_time::ptime pt2;</span><br><span class="line">	<span class="type">const</span> <span class="type">char</span> * m_func_name;</span><br><span class="line">	<span class="type">int</span> m_times = <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ONCE_PROFILER() profiler _profiler_instance##__LINE__(__FUNCTION__)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BEGIN_PROFILE_ONE(name) profiler _profiler_##name(#name)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BEGIN_PROFILE_TIMES(name,times) profiler _profiler_##name(#name,times)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BEGIN_PROFILE(name,...) profiler _profiler_##name(#name, ##__VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> END_PROFILE(name)  _profiler_##name.stop()			</span></span><br></pre></td></tr></table></figure>

<h4 id="usage-1"><a href="#usage-1" class="headerlink" title="usage"></a>usage</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">BEGIN_PROFILE</span>(LoadImage);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">load_image</span>();</span><br><span class="line">	</span><br><span class="line"><span class="built_in">END_PROFILE</span>(LoadImage); </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="built_in">BEGIN_PROFILE_TIMES</span>(ProcessImageTimes, <span class="number">100</span>);</span><br><span class="line"><span class="comment">//BEGIN_PROFILE(ProcessImageTimes, 100);</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">		<span class="built_in">process_image</span>();</span><br><span class="line">	&#125;</span><br><span class="line"><span class="built_in">END_PROFILE</span>(ProcessImageTimes);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/pfultz2/Cloak/wiki/C-Preprocessor-tricks,-tips,-and-idioms">C-Preprocessor-tricks,-tips,-and-idioms</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20191010: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/esay-profiler-for-cpp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/esay-profiler-for-cpp/" class="post-title-link" itemprop="url">tutorial to compile and use esay profiler with c++ on ubuntu 16.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-10 14:14:00" itemprop="dateCreated datePublished" datetime="2019-10-10T14:14:00+08:00">2019-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="compile"><a href="#compile" class="headerlink" title="compile"></a>compile</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/yse/easy_profiler.git</span><br><span class="line"><span class="built_in">cd</span> easy_profiler &amp;&amp; <span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build &amp;&amp; cmake-gui ..</span><br><span class="line"></span><br><span class="line">make -j8</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure>

<h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><h4 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(easy_profiler REQUIRED)</span><br><span class="line"><span class="comment">#easy_profiler_Dir /usr/local/lib/cmake/easy_profiler</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(my_application easy_profiler) </span><br></pre></td></tr></table></figure>

<h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;easy/profiler.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">EASY_FUNCTION</span>(profiler::colors::Magenta); <span class="comment">// Magenta block with name &quot;foo&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">EASY_BLOCK</span>(<span class="string">&quot;Calculating sum&quot;</span>); <span class="comment">// Begin block with default color == Amber100</span></span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">EASY_BLOCK</span>(<span class="string">&quot;Addition&quot;</span>, profiler::colors::Red); <span class="comment">// Scoped red block (no EASY_END_BLOCK needed)</span></span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    EASY_END_BLOCK; <span class="comment">// End of &quot;Calculating sum&quot; block</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">EASY_BLOCK</span>(<span class="string">&quot;Calculating multiplication&quot;</span>, profiler::colors::Blue500); <span class="comment">// Blue block</span></span><br><span class="line">    <span class="type">int</span> mul = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">11</span>; ++i)</span><br><span class="line">        mul *= i;</span><br><span class="line">    <span class="comment">//EASY_END_BLOCK; // This is not needed because all blocks are ended on destructor when closing braces met</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">EASY_FUNCTION</span>(<span class="number">0xfff080aa</span>); <span class="comment">// Function block with custom ARGB color</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">baz</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">EASY_FUNCTION</span>(); <span class="comment">// Function block with default color == Amber100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/yse/easy_profiler">easy_profiler</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20191010: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/opencv-matrix-multiplication-vs-element-wise-multiplication/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/opencv-matrix-multiplication-vs-element-wise-multiplication/" class="post-title-link" itemprop="url">opencv and numpy matrix multiplication vs element-wise multiplication</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-09 17:51:00" itemprop="dateCreated datePublished" datetime="2019-10-09T17:51:00+08:00">2019-10-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cpp/" itemprop="url" rel="index"><span itemprop="name">cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="opencv"><a href="#opencv" class="headerlink" title="opencv"></a>opencv</h3><p><code>Matrix multiplication</code> is where two matrices are multiplied directly. This operation multiplies matrix A of size <code>[a x b]</code> with matrix B of size <code>[b x c]</code> to produce matrix C of size <code>[a x c]</code>. </p>
<p>In OpenCV it is achieved using the simple <code>*</code> operator:</p>
<pre><code>C = A * B  // Aab * Bbc = Cac
</code></pre>
<p><code>Element-wise multiplication</code> is where each pixel in the output matrix is formed by multiplying that pixel in matrix A by its corresponding entry in matrix B. The input matrices should be the same size, and the output will be the same size as well. This is achieved using the <code>mul()</code> function:</p>
<pre><code>output = A.mul(B); // A B must have same size !!!
</code></pre>
<h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cv::Mat <span class="title">cv_matmul</span><span class="params">(<span class="type">const</span> cv::Mat&amp; A, <span class="type">const</span> cv::Mat&amp; B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// matrix multipication    m*k,  k*n ===&gt; m*n</span></span><br><span class="line">	cv::Mat C = A * B; </span><br><span class="line">	<span class="keyword">return</span> C; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">cv::Mat <span class="title">cv_mul</span><span class="params">(<span class="type">const</span> cv::Mat&amp; image, <span class="type">const</span> cv::Mat&amp; mask)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// element-wise multiplication  output[i,j] = image[i,j] * mask[i,j]</span></span><br><span class="line">	cv::Mat output = image.<span class="built_in">mul</span>(mask, <span class="number">1.0</span>); <span class="comment">// m*n,  m*n</span></span><br><span class="line">	<span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">cv::Mat <span class="title">cv_multiply3x1</span><span class="params">(<span class="type">const</span> cv::Mat&amp; mat3, <span class="type">const</span> cv::Mat&amp; mat1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	std::vector&lt;cv::Mat&gt; channels;</span><br><span class="line">	cv::<span class="built_in">split</span>(mat3, channels);</span><br><span class="line"></span><br><span class="line">	std::vector&lt;cv::Mat&gt; result_channels;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; channels.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		result_channels.<span class="built_in">push_back</span>(channels[i].<span class="built_in">mul</span>(mat1));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cv::Mat result3;</span><br><span class="line">	cv::<span class="built_in">merge</span>(result_channels, result3);</span><br><span class="line">	<span class="keyword">return</span> result3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">cv::Mat <span class="title">cv_multiply3x3</span><span class="params">(<span class="type">const</span> cv::Mat&amp; mat3_a, <span class="type">const</span> cv::Mat&amp; mat3_b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cv::Mat a;</span><br><span class="line">	cv::Mat b;</span><br><span class="line">	cv::Mat c;</span><br><span class="line"></span><br><span class="line">	std::vector&lt;cv::Mat&gt; a_channels;</span><br><span class="line">	std::vector&lt;cv::Mat&gt; b_channels;</span><br><span class="line">	std::vector&lt;cv::Mat&gt; c_channels;</span><br><span class="line"></span><br><span class="line">	cv::<span class="built_in">split</span>(mat3_a, a_channels);</span><br><span class="line">	cv::<span class="built_in">split</span>(mat3_b, b_channels);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; a_channels.<span class="built_in">size</span>() || b_channels.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		c_channels.<span class="built_in">push_back</span>(a_channels[i].<span class="built_in">mul</span>(b_channels[i]));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cv::<span class="built_in">merge</span>(c_channels, c);</span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="numpy"><a href="#numpy" class="headerlink" title="numpy"></a>numpy</h3><blockquote>
<p>numpy arrays are not matrices, and the standard operations <code>*, +, -, /</code> work element-wise on arrays.</p>
</blockquote>
<blockquote>
<p>Instead, you could try using <code>numpy.matrix</code>, and <code>*</code> will be treated like <code>matrix multiplication</code>.</p>
</blockquote>
<h4 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h4><p><code>Element-wise multiplication</code> code</p>
<pre><code>&gt;&gt;&gt; img = np.array([1,2,3,4,5,6,7,8]).reshape(2,4)
&gt;&gt;&gt; mask = np.array([1,1,1,1,0,0,0,0]).reshape(2,4)
&gt;&gt;&gt; img * mask 
array([[1, 2, 3, 4],
       [0, 0, 0, 0]])
&gt;&gt;&gt; 
&gt;&gt;&gt; np.multiply(img, mask)
array([[1, 2, 3, 4],
       [0, 0, 0, 0]])
</code></pre>
<blockquote>
<p>for <code>numpy.array</code>, <code>*</code>and <code>multiply</code> work element-wise  </p>
</blockquote>
<p><code>matrix multiplication</code> code</p>
<pre><code>&gt;&gt;&gt; a = np.array([1,2,3,4,5,6,7,8]).reshape(2,4)
&gt;&gt;&gt; b = np.array([1,1,1,1,0,0,0,0]).reshape(4,2)
&gt;&gt;&gt; np.matmul(a,b)
array([[ 3,  3],
       [11, 11]])

&gt;&gt;&gt; np.dot(a,b)
array([[ 3,  3],
       [11, 11]])

&gt;&gt;&gt; a = np.matrix([1,2,3,4,5,6,7,8]).reshape(2,4)
&gt;&gt;&gt; b = np.matrix([1,1,1,1,0,0,0,0]).reshape(4,2)
&gt;&gt;&gt; a
matrix([[1, 2, 3, 4],
        [5, 6, 7, 8]])
&gt;&gt;&gt; b
matrix([[1, 1],
        [1, 1],
        [0, 0],
        [0, 0]])
&gt;&gt;&gt; a*b
matrix([[ 3,  3],
        [11, 11]])

&gt;&gt;&gt; np.matmul(a,b)
matrix([[ 3,  3],
        [11, 11]])
</code></pre>
<blockquote>
<p>for 2-dim, <code>np.dot</code> equals <code>np.matmul</code><br>for <code>numpy.array</code>, <code>np.matmul</code> means <code>matrix multiplication</code>;<br>for <code>numpy.matrix</code>, <code>*</code> and <code>np.matmul</code> means <code>matrix multiplication</code>;</p>
</blockquote>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/10936099/matrix-multiplication-in-opencv">matrix-multiplication-in-opencv</a></li>
<li><a target="_blank" rel="noopener" href="https://answers.opencv.org/question/63026/cvmat-element-matrix-multiplication/">cvmat-element-matrix-multiplication</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20190109: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/flask-jinja-templates/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/flask-jinja-templates/" class="post-title-link" itemprop="url">tutorial to use python flask jinja templates and a realtime video demo</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-05 17:42:00" itemprop="dateCreated datePublished" datetime="2019-10-05T17:42:00+08:00">2019-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="Jinja-delimiters"><a href="#Jinja-delimiters" class="headerlink" title="Jinja delimiters"></a>Jinja delimiters</h3><p>The default Jinja delimiters are configured as follows:</p>
<pre><code>&#123;% ... %&#125; for Statements
&#123;&#123; ... &#125;&#125; for Expressions to print to the template output
 for Comments not included in the template output
#  ... ## for Line Statements
</code></pre>
<h3 id="url-for-static-css-image"><a href="#url-for-static-css-image" class="headerlink" title="url_for static(css+image)"></a>url_for static(css+image)</h3><pre><code>&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&#123;&#123; url_for('static', filename='bootstrap/bootstrap.min.css') &#125;&#125;&quot;&gt;

&lt;img src=&quot;&#123;&#123; url_for('static', filename='images/1.PNG') &#125;&#125;&quot; height=&quot;&#123;&#123;query_img_height&#125;&#125;&quot; width=&quot;&#123;&#123;query_img_width&#125;&#125;&quot;&gt;
</code></pre>
<blockquote>
<p>You have by default the <code>static</code> endpoint for static files.</p>
</blockquote>
<p>will be converted to </p>
<pre><code>&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/bootstrap/bootstrap.min.css&quot;&gt;
&lt;img src=&quot;/static/images/1.PNG&quot; height=&quot;1799&quot; width=&quot;896&quot;&gt;
</code></pre>
<p>if we place js and css files in <code>static</code> folder, then we can use  </p>
<pre><code>&lt;script src=&quot;static/js/lib/jquery-3.4.1.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>to replace</p>
<pre><code> &lt;script src=&quot;&#123;&#123; url_for('static', filename = 'js/lib/jquery-3.4.1.min.js') &#125;&#125;&quot;&gt;&lt;/script&gt;
</code></pre>
<h3 id="url-for-static-pass-image-path"><a href="#url-for-static-pass-image-path" class="headerlink" title="url for static(pass image path)"></a>url for static(pass image path)</h3><pre><code>&lt;h1&gt;Image  &#123;&#123;image_filename&#125;&#125;&lt;/h1&gt;
&lt;img src=&quot;&#123;&#123; url_for('static', filename = image_filename) &#125;&#125;&quot; height=&quot;&#123;&#123;query_img_height&#125;&#125;&quot; width=&quot;&#123;&#123;query_img_width&#125;&#125;&quot;&gt;
</code></pre>
<blockquote>
<p>notice we do’t use </p>
</blockquote>
<pre><code>filename = &#123;&#123;image_filename&#125;&#125;
</code></pre>
<blockquote>
<p><code>image_filename</code> will be passed to html with value <code>images/1.PNG</code></p>
</blockquote>
<p>will be converted to </p>
<pre><code>&lt;h1&gt;Image  images/1.PNG &lt;/h1&gt;
&lt;img src=&quot;/static/images/1.PNG&quot; height=&quot;1799&quot; width=&quot;896&quot;&gt;
</code></pre>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><pre><code>&#123;% set result_count = result_list | length %&#125;

&#123;&#123; index | string ) &#125;&#125;
</code></pre>
<blockquote>
<p>filter: length, string</p>
</blockquote>
<h3 id="debug-html"><a href="#debug-html" class="headerlink" title="debug html"></a>debug html</h3><p><img src="https://kezunlin.me/images/posts/635233-20191007110914605-68892998.png" alt="debug jinja2 html"></p>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- kzl in-article ad -->
<p><ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5653382914441020"
     data-ad-slot="7925631830"></ins></p>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


<h3 id="url-for-with-params"><a href="#url-for-with-params" class="headerlink" title="url_for with params"></a>url_for with params</h3><p>python code</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;you are in the index page&#x27;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/questions/&lt;int:question_id&gt;&#x27;</span></span>):    </span></span><br><span class="line"><span class="comment">#int has been used as a filter that only integer will be passed </span></span><br><span class="line"><span class="comment"># in the url otherwise it will give a 404 error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_question</span>(<span class="params">question_id</span>):  </span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&#x27;you asked for question &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(question_id))</span><br></pre></td></tr></table></figure>

<p>html page</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#123;&#123;</span> <span class="attr">url_for</span>(&#x27;<span class="attr">index</span>&#x27;) &#125;&#125;&gt;</span>Index<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span> = <span class="string">&#123;&#123;</span> <span class="attr">url_for</span>(&#x27;<span class="attr">find_question</span>&#x27; ,<span class="attr">question_id</span>=<span class="string">1)</span> &#125;&#125;&gt;</span>Question 1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% if kline_chart %&#125;</span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;chart&quot;</span>&gt;</span>&#123;&#123; kline_chart | safe &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Realtime-Video"><a href="#Realtime-Video" class="headerlink" title="Realtime Video"></a>Realtime Video</h2><h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;video_feed&#x27;) &#125;&#125;&quot;</span> <span class="attr">height</span>=<span class="string">&quot;480&quot;</span> <span class="attr">width</span>=<span class="string">&quot;640&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="main-py"><a href="#main-py" class="headerlink" title="main.py"></a>main.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#===================================================</span></span><br><span class="line">outputFrame = <span class="literal">None</span></span><br><span class="line">lock = threading.Lock()</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize a flask object</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">	<span class="comment"># return the rendered template</span></span><br><span class="line">	<span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>():</span><br><span class="line">    	<span class="comment"># grab global references to the output frame and lock variables</span></span><br><span class="line">	<span class="keyword">global</span> outputFrame, lock</span><br><span class="line"></span><br><span class="line">	<span class="comment"># loop over frames from the output stream</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="comment"># wait until the lock is acquired</span></span><br><span class="line">		<span class="keyword">with</span> lock:</span><br><span class="line">			<span class="comment"># check if the output frame is available, otherwise skip</span></span><br><span class="line">			<span class="comment"># the iteration of the loop</span></span><br><span class="line">			<span class="keyword">if</span> outputFrame <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">			<span class="comment"># encode the frame in JPEG format</span></span><br><span class="line">			(flag, encodedImage) = cv2.imencode(<span class="string">&quot;.jpg&quot;</span>, outputFrame)</span><br><span class="line"></span><br><span class="line">			<span class="comment"># ensure the frame was successfully encoded</span></span><br><span class="line">			<span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">		<span class="comment"># yield the output frame in the byte format</span></span><br><span class="line">		<span class="keyword">yield</span>(<span class="string">b&#x27;--frame\r\n&#x27;</span> <span class="string">b&#x27;Content-Type: image/jpeg\r\n\r\n&#x27;</span> +</span><br><span class="line">			<span class="built_in">bytearray</span>(encodedImage) + <span class="string">b&#x27;\r\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/video_feed&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">video_feed</span>():</span><br><span class="line">	<span class="comment"># return the response generated along with the specific media</span></span><br><span class="line">	<span class="comment"># type (mime type)</span></span><br><span class="line">	<span class="keyword">return</span> Response(generate(),</span><br><span class="line">		mimetype = <span class="string">&quot;multipart/x-mixed-replace; boundary=frame&quot;</span>)</span><br><span class="line"><span class="comment">#===================================================</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># start the flask app</span></span><br><span class="line">args = &#123;<span class="string">&quot;ip&quot;</span>:<span class="string">&quot;0.0.0.0&quot;</span>,<span class="string">&quot;port&quot;</span>:<span class="number">8888</span>&#125;</span><br><span class="line">app.run(host=args[<span class="string">&quot;ip&quot;</span>], port=args[<span class="string">&quot;port&quot;</span>], debug=<span class="literal">True</span>,</span><br><span class="line">		threaded=<span class="literal">True</span>, use_reloader=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><h3 id="index"><a href="#index" class="headerlink" title="index"></a>index</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># for web</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,Response,render_template</span><br><span class="line"></span><br><span class="line">web_params = &#123;</span><br><span class="line">    <span class="string">&quot;query_key&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;query_segimg_filepath&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;query_segmask_filepath&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;query_img_height&quot;</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;query_img_width&quot;</span>:<span class="number">0</span>,</span><br><span class="line">    <span class="string">&quot;result_list&quot;</span>: []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize a flask object</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">_<span class="built_in">dir</span> = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">app.template_folder = os.path.join(_<span class="built_in">dir</span>, <span class="string">&quot;templates&quot;</span>)</span><br><span class="line">app.static_folder = os.path.join(_<span class="built_in">dir</span>, <span class="string">&quot;static&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(app.template_folder)</span><br><span class="line"><span class="built_in">print</span>(app.static_folder)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">global</span> web_params</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;search.html&quot;</span>,**web_params)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># start the flask app</span></span><br><span class="line">args = &#123;<span class="string">&quot;ip&quot;</span>:<span class="string">&quot;0.0.0.0&quot;</span>,<span class="string">&quot;port&quot;</span>:<span class="number">8888</span>&#125;</span><br><span class="line">app.run(host=args[<span class="string">&quot;ip&quot;</span>], port=args[<span class="string">&quot;port&quot;</span>], debug=<span class="literal">True</span>,threaded=<span class="literal">True</span>, use_reloader=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="index-html-1"><a href="#index-html-1" class="headerlink" title="index.html"></a>index.html</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Query &#123;&#123;query_key&#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Query Image &#123;&#123; query_segimg_filepath &#125;&#125; <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    &#123;# </span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;images/1.PNG&#x27;) &#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">height</span>=<span class="string">&quot;30&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">width</span>=<span class="string">&quot;30&quot;</span>&gt;</span></span><br><span class="line">    #&#125;</span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename = query_segimg_filepath) &#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">height</span>=<span class="string">&quot;&#123;&#123;query_img_height&#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">width</span>=<span class="string">&quot;&#123;&#123;query_img_width&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">    &#123;# </span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename = query_segmask_filepath) &#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">height</span>=<span class="string">&quot;&#123;&#123;query_img_height&#125;&#125;&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">width</span>=<span class="string">&quot;&#123;&#123;query_img_width&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">    &#123;% set result_count = result_list | length %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Search Results #&#123;&#123;result_count&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    &#123;% for i in range(0,result_count) %&#125;</span><br><span class="line">      &#123;% set item = result_list[i] %&#125;</span><br><span class="line">      &#123;% set segimg_filepath = item[&quot;segimg_filepath&quot;] %&#125;</span><br><span class="line">      &#123;% set segmask_filepath = item[&quot;segmask_filepath&quot;] %&#125;</span><br><span class="line"></span><br><span class="line">      &#123;% set img_height = item[&quot;height&quot;] %&#125;</span><br><span class="line">      &#123;% set img_width = item[&quot;width&quot;] %&#125;</span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Top # &#123;&#123;i&#125;&#125;  &#123;&#123; segimg_filepath &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename = segimg_filepath) &#125;&#125;&quot;</span> <span class="attr">height</span>=<span class="string">&quot;&#123;&#123;img_height&#125;&#125;&quot;</span> <span class="attr">width</span>=<span class="string">&quot;&#123;&#123;img_width&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">      &#123;# </span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename = segmask_filepath) &#125;&#125;&quot;</span> <span class="attr">height</span>=<span class="string">&quot;&#123;&#123;img_height&#125;&#125;&quot;</span> <span class="attr">width</span>=<span class="string">&quot;&#123;&#123;img_width&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">      #&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/16351826/link-to-flask-static-files-with-url-for">link-to-flask-static-files-with-url-for</a></li>
<li><a target="_blank" rel="noopener" href="https://jinja.palletsprojects.com/en/2.10.x/templates/#length">Template Designer Documentation</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20191005: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/pymongo-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/pymongo-tutorial/" class="post-title-link" itemprop="url">pymongo and mongoengine tutorial on ubuntu 16.04</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-26 14:31:00" itemprop="dateCreated datePublished" datetime="2019-09-26T14:31:00+08:00">2019-09-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>pymongo and mongoengine tutorial on ubuntu 16.04</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/blog/pymongo-tutorial/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/csharp-key-press-event/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/csharp-key-press-event/" class="post-title-link" itemprop="url">csharp key press event tutorial and app.config</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-19 12:51:00" itemprop="dateCreated datePublished" datetime="2019-09-19T12:51:00+08:00">2019-09-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/csharp/" itemprop="url" rel="index"><span itemprop="name">csharp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="MainForm"><a href="#MainForm" class="headerlink" title="MainForm"></a>MainForm</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="built_in">bool</span> <span class="title">ProcessCmdKey</span>(<span class="params"><span class="keyword">ref</span> Message msg, Keys keyData</span>)</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="comment">//System.Console.WriteLine(&quot;ProcessCmdKey &quot; + cur_image_id);</span></span><br><span class="line"></span><br><span class="line">           <span class="comment">//capture up arrow key</span></span><br><span class="line">           <span class="keyword">if</span> (keyData == Keys.Left)</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="comment">//this.button_prev.PerformClick();</span></span><br><span class="line">               button_prev_click();</span><br><span class="line"></span><br><span class="line">               <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span> <span class="keyword">if</span> (keyData == Keys.Right)</span><br><span class="line">           &#123;</span><br><span class="line">               <span class="comment">//System.Console.WriteLine(&quot;Enter &quot;+cur_image_id);</span></span><br><span class="line"></span><br><span class="line">               <span class="comment">//this.button_ok.PerformClick();</span></span><br><span class="line">               button_ok_click();</span><br><span class="line"></span><br><span class="line">               <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           </span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">base</span>.ProcessCmdKey(<span class="keyword">ref</span> msg, keyData); <span class="comment">// trigger 2 button_ok_click</span></span><br><span class="line">       &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="TextBox"><a href="#TextBox" class="headerlink" title="TextBox"></a>TextBox</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">textBox_index_KeyDown</span>(<span class="params"><span class="built_in">object</span> sender, KeyEventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (e.KeyCode == Keys.Enter)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//enter key is down</span></span><br><span class="line">                button_goto_click();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>


<h3 id="app-config"><a href="#app-config" class="headerlink" title="app.config"></a>app.config</h3><h4 id="app-config-xml"><a href="#app-config-xml" class="headerlink" title="app.config.xml"></a>app.config.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">startup</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">supportedRuntime</span> <span class="attr">version</span>=<span class="string">&quot;v4.0&quot;</span> <span class="attr">sku</span>=<span class="string">&quot;.NETFramework,Version=v4.5.2&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appSettings</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;image_extension&quot;</span> <span class="attr">value</span>=<span class="string">&quot;png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;output_filepath&quot;</span> <span class="attr">value</span>=<span class="string">&quot;./output.json&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appSettings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h4><blockquote>
<p>reference <code>System.Configuration.dll</code></p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init_config</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> appSettings = System.Configuration.ConfigurationManager.AppSettings;</span><br><span class="line">            <span class="built_in">string</span> image_ext = <span class="string">&quot;*.&quot;</span>+ appSettings[<span class="string">&quot;image_extension&quot;</span>];</span><br><span class="line">            <span class="built_in">string</span> output_filepath = appSettings[<span class="string">&quot;output_filepath&quot;</span>];</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/3752451/enter-key-pressed-event-handler">enter-key-pressed-event-handler</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20190919:  created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/radam/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/radam/" class="post-title-link" itemprop="url">python keras RAdam tutorial and load custom optimizer with CustomObjectScope</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-12 13:04:00" itemprop="dateCreated datePublished" datetime="2019-09-12T13:04:00+08:00">2019-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deep-learning/" itemprop="url" rel="index"><span itemprop="name">deep learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="RAdam"><a href="#RAdam" class="headerlink" title="RAdam"></a>RAdam</h2><h3 id="usage"><a href="#usage" class="headerlink" title="usage"></a>usage</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> keras_radam <span class="keyword">import</span> RAdam</span><br><span class="line"></span><br><span class="line"><span class="comment"># Build toy model with RAdam optimizer</span></span><br><span class="line">model = keras.models.Sequential()</span><br><span class="line">model.add(keras.layers.Dense(input_shape=(<span class="number">17</span>,), units=<span class="number">3</span>))</span><br><span class="line">model.<span class="built_in">compile</span>(RAdam(), loss=<span class="string">&#x27;mse&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate toy data</span></span><br><span class="line">x = np.random.standard_normal((<span class="number">4096</span> * <span class="number">30</span>, <span class="number">17</span>))</span><br><span class="line">w = np.random.standard_normal((<span class="number">17</span>, <span class="number">3</span>))</span><br><span class="line">y = np.dot(x, w)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fit</span></span><br><span class="line">model.fit(x, y, epochs=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h3 id="use-warmup"><a href="#use-warmup" class="headerlink" title="use warmup"></a>use warmup</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras_radam <span class="keyword">import</span> RAdam</span><br><span class="line"></span><br><span class="line">RAdam(total_steps=<span class="number">10000</span>, warmup_proportion=<span class="number">0.1</span>, min_lr=<span class="number">1e-5</span>)</span><br></pre></td></tr></table></figure>


<h3 id="load-custom-optimizer"><a href="#load-custom-optimizer" class="headerlink" title="load custom optimizer"></a>load custom optimizer</h3><p>keras load model with custom optimizer with CustomObjectScope</p>
<h4 id="error"><a href="#error" class="headerlink" title="error"></a>error</h4><p>when load model with custom optimizer, eg <code>RAdam()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model = load_model(<span class="string">&quot;resnet50_radam_model.h5&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>output error</p>
<pre><code>ValueError: Unknown optimizer: RAdam
</code></pre>
<h4 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> keras_radam <span class="keyword">import</span> RAdam</span><br><span class="line"><span class="keyword">from</span> keras.utils <span class="keyword">import</span> CustomObjectScope</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> CustomObjectScope(&#123;<span class="string">&#x27;RAdam&#x27;</span>: RAdam()&#125;):</span><br><span class="line">    best_model_filepath = <span class="string">&quot;./checkpoint/best_model_efnb0.h5&quot;</span></span><br><span class="line">    model = load_model(best_model_filepath)</span><br><span class="line">    model.save_weights(<span class="string">&quot;./checkpoint/weights_efnb0.h5&quot;</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1908.03265">On the Variance of the Adaptive Learning Rate and Beyond</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/LiyuanLucasLiu/RAdam">RAdam official Pytorch Version</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CyberZHG/keras-radam">https://github.com/CyberZHG/keras-radam</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20190912: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/efficientnet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/efficientnet/" class="post-title-link" itemprop="url">keras efficientnet introduction</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-12 09:54:00" itemprop="dateCreated datePublished" datetime="2019-09-12T09:54:00+08:00">2019-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deep-learning/" itemprop="url" rel="index"><span itemprop="name">deep learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="About-EfficientNet-Models"><a href="#About-EfficientNet-Models" class="headerlink" title="About EfficientNet Models"></a>About EfficientNet Models</h3><p><img src="https://kezunlin.me/images/posts/635233-20190912095823319-1994858033.png" alt="params"><br><img src="https://kezunlin.me/images/posts/635233-20190912095826925-710547982.png" alt="flops"></p>
<blockquote>
<p>compared with resnet50, EfficientNet-B4 improves the top-1 accuracy from 76.3% of ResNet-50 to 82.6% (+6.3%), under similar FLOPS constraint.</p>
</blockquote>
<h3 id="Using-Pretrained-EfficientNet-Checkpoints"><a href="#Using-Pretrained-EfficientNet-Checkpoints" class="headerlink" title="Using Pretrained EfficientNet Checkpoints"></a>Using Pretrained EfficientNet Checkpoints</h3><p><img src="https://kezunlin.me/images/posts/635233-20190912100138476-1059619699.png" alt="b0-b7 top-1 on imagenet"></p>
<h3 id="Keras-Models-Performance"><a href="#Keras-Models-Performance" class="headerlink" title="Keras Models Performance"></a>Keras Models Performance</h3><ul>
<li>The top-k errors were obtained using Keras Applications with the <strong>TensorFlow backend</strong> on the <strong>2012 ILSVRC ImageNet validation set</strong> and may slightly differ from the original ones.</li>
</ul>
<blockquote>
<p>The input size used was 224x224 for all models except NASNetLarge (331x331), InceptionV3 (299x299), InceptionResNetV2 (299x299), Xception (299x299),<br>EfficientNet-B0 (224x224), EfficientNet-B1 (240x240), EfficientNet-B2 (260x260), EfficientNet-B3 (300x300), EfficientNet-B4 (380x380), EfficientNet-B5 (456x456), EfficientNet-B6 (528x528), and EfficientNet-B7 (600x600).</p>
</blockquote>
<p>notice</p>
<ul>
<li>Top-1: single center crop, top-1 error</li>
<li>Top-5: single center crop, top-5 error</li>
<li>10-5: ten crops (1 center + 4 corners and those mirrored ones), top-5 error</li>
<li>Size: rounded the number of parameters when <code>include_top=True</code></li>
<li>Stem: rounded the number of parameters when <code>include_top=False</code></li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>Top-1</th>
<th>Top-5</th>
<th>10-5</th>
<th>Size</th>
<th>Stem</th>
<th>References</th>
</tr>
</thead>
<tbody><tr>
<td><a href="keras_applications/vgg16.py">VGG16</a></td>
<td>28.732</td>
<td>9.950</td>
<td>8.834</td>
<td>138.4M</td>
<td>14.7M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.1556">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/vgg.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/vgg19.py">VGG19</a></td>
<td>28.744</td>
<td>10.012</td>
<td>8.774</td>
<td>143.7M</td>
<td>20.0M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1409.1556">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/vgg.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnet50.py">ResNet50</a></td>
<td>25.072</td>
<td>7.940</td>
<td>6.828</td>
<td>25.6M</td>
<td>23.6M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.03385">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/resnet_v1.py">[tf-models]</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/fb.resnet.torch/blob/master/models/resnet.lua">[torch]</a> <a target="_blank" rel="noopener" href="https://github.com/KaimingHe/deep-residual-networks/blob/master/prototxt/ResNet-50-deploy.prototxt">[caffe]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnet.py">ResNet101</a></td>
<td>23.580</td>
<td>7.214</td>
<td>6.092</td>
<td>44.7M</td>
<td>42.7M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.03385">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/resnet_v1.py">[tf-models]</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/fb.resnet.torch/blob/master/models/resnet.lua">[torch]</a> <a target="_blank" rel="noopener" href="https://github.com/KaimingHe/deep-residual-networks/blob/master/prototxt/ResNet-101-deploy.prototxt">[caffe]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnet.py">ResNet152</a></td>
<td>23.396</td>
<td>6.882</td>
<td>5.908</td>
<td>60.4M</td>
<td>58.4M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.03385">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/resnet_v1.py">[tf-models]</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/fb.resnet.torch/blob/master/models/resnet.lua">[torch]</a> <a target="_blank" rel="noopener" href="https://github.com/KaimingHe/deep-residual-networks/blob/master/prototxt/ResNet-152-deploy.prototxt">[caffe]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnet_v2.py">ResNet50V2</a></td>
<td>24.040</td>
<td>6.966</td>
<td>5.896</td>
<td>25.6M</td>
<td>23.6M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1603.05027">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/resnet_v2.py">[tf-models]</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/fb.resnet.torch/blob/master/models/preresnet.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnet_v2.py">ResNet101V2</a></td>
<td>22.766</td>
<td>6.184</td>
<td>5.158</td>
<td>44.7M</td>
<td>42.6M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1603.05027">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/resnet_v2.py">[tf-models]</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/fb.resnet.torch/blob/master/models/preresnet.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnet_v2.py">ResNet152V2</a></td>
<td>21.968</td>
<td>5.838</td>
<td>4.900</td>
<td>60.4M</td>
<td>58.3M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1603.05027">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/resnet_v2.py">[tf-models]</a> <a target="_blank" rel="noopener" href="https://github.com/facebook/fb.resnet.torch/blob/master/models/preresnet.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnext.py">ResNeXt50</a></td>
<td>22.260</td>
<td>6.190</td>
<td>5.410</td>
<td>25.1M</td>
<td>23.0M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1611.05431">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/facebookresearch/ResNeXt/blob/master/models/resnext.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/resnext.py">ResNeXt101</a></td>
<td>21.270</td>
<td>5.706</td>
<td>4.842</td>
<td>44.3M</td>
<td>42.3M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1611.05431">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/facebookresearch/ResNeXt/blob/master/models/resnext.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/inception_v3.py">InceptionV3</a></td>
<td>22.102</td>
<td>6.280</td>
<td>5.038</td>
<td>23.9M</td>
<td>21.8M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1512.00567">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/inception_v3.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/inception_resnet_v2.py">InceptionResNetV2</a></td>
<td>19.744</td>
<td>4.748</td>
<td>3.962</td>
<td>55.9M</td>
<td>54.3M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1602.07261">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/inception_resnet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/xception.py">Xception</a></td>
<td>20.994</td>
<td>5.548</td>
<td>4.738</td>
<td>22.9M</td>
<td>20.9M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1610.02357">[paper]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet.py">MobileNet(alpha&#x3D;0.25)</a></td>
<td>48.418</td>
<td>24.208</td>
<td>21.196</td>
<td>0.5M</td>
<td>0.2M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1704.04861">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet.py">MobileNet(alpha&#x3D;0.50)</a></td>
<td>35.708</td>
<td>14.376</td>
<td>12.180</td>
<td>1.3M</td>
<td>0.8M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1704.04861">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet.py">MobileNet(alpha&#x3D;0.75)</a></td>
<td>31.588</td>
<td>11.758</td>
<td>9.878</td>
<td>2.6M</td>
<td>1.8M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1704.04861">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet.py">MobileNet(alpha&#x3D;1.0)</a></td>
<td>29.576</td>
<td>10.496</td>
<td>8.774</td>
<td>4.3M</td>
<td>3.2M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1704.04861">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet_v2.py">MobileNetV2(alpha&#x3D;0.35)</a></td>
<td>39.914</td>
<td>17.568</td>
<td>15.422</td>
<td>1.7M</td>
<td>0.4M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.04381">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet_v2.py">MobileNetV2(alpha&#x3D;0.50)</a></td>
<td>34.806</td>
<td>13.938</td>
<td>11.976</td>
<td>2.0M</td>
<td>0.7M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.04381">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet_v2.py">MobileNetV2(alpha&#x3D;0.75)</a></td>
<td>30.468</td>
<td>10.824</td>
<td>9.188</td>
<td>2.7M</td>
<td>1.4M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.04381">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet_v2.py">MobileNetV2(alpha&#x3D;1.0)</a></td>
<td>28.664</td>
<td>9.858</td>
<td>8.322</td>
<td>3.5M</td>
<td>2.3M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.04381">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet_v2.py">MobileNetV2(alpha&#x3D;1.3)</a></td>
<td>25.320</td>
<td>7.878</td>
<td>6.728</td>
<td>5.4M</td>
<td>3.8M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.04381">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/mobilenet_v2.py">MobileNetV2(alpha&#x3D;1.4)</a></td>
<td>24.770</td>
<td>7.578</td>
<td>6.518</td>
<td>6.2M</td>
<td>4.4M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1801.04381">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet/mobilenet_v2.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/densenet.py">DenseNet121</a></td>
<td>25.028</td>
<td>7.742</td>
<td>6.522</td>
<td>8.1M</td>
<td>7.0M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1608.06993">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/liuzhuang13/DenseNet/blob/master/models/densenet.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/densenet.py">DenseNet169</a></td>
<td>23.824</td>
<td>6.824</td>
<td>5.860</td>
<td>14.3M</td>
<td>12.6M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1608.06993">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/liuzhuang13/DenseNet/blob/master/models/densenet.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/densenet.py">DenseNet201</a></td>
<td>22.680</td>
<td>6.380</td>
<td>5.466</td>
<td>20.2M</td>
<td>18.3M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1608.06993">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/liuzhuang13/DenseNet/blob/master/models/densenet.lua">[torch]</a></td>
</tr>
<tr>
<td><a href="keras_applications/nasnet.py">NASNetLarge</a></td>
<td>17.502</td>
<td>3.996</td>
<td>3.412</td>
<td>93.5M</td>
<td>84.9M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1707.07012">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/nasnet/nasnet.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/nasnet.py">NASNetMobile</a></td>
<td>25.634</td>
<td>8.146</td>
<td>6.758</td>
<td>7.7M</td>
<td>4.3M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1707.07012">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/slim/nets/nasnet/nasnet.py">[tf-models]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B0</a></td>
<td>22.810</td>
<td>6.508</td>
<td>5.858</td>
<td>5.3M</td>
<td>4.0M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B1</a></td>
<td>20.866</td>
<td>5.552</td>
<td>5.050</td>
<td>7.9M</td>
<td>6.6M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B2</a></td>
<td>19.820</td>
<td>5.054</td>
<td>4.538</td>
<td>9.2M</td>
<td>7.8M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B3</a></td>
<td>18.422</td>
<td>4.324</td>
<td>3.902</td>
<td>12.3M</td>
<td>10.8M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B4</a></td>
<td>17.040</td>
<td>3.740</td>
<td>3.344</td>
<td>19.5M</td>
<td>17.7M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B5</a></td>
<td>16.298</td>
<td>3.290</td>
<td>3.114</td>
<td>30.6M</td>
<td>28.5M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B6</a></td>
<td>15.918</td>
<td>3.102</td>
<td>2.916</td>
<td>43.3M</td>
<td>41.0M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
<tr>
<td><a href="keras_applications/efficientnet.py">EfficientNet-B7</a></td>
<td>15.570</td>
<td>3.160</td>
<td>2.906</td>
<td>66.7M</td>
<td>64.1M</td>
<td><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1905.11946">[paper]</a> <a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">[tf-tpu]</a></td>
</tr>
</tbody></table>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">tf efficientnet</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/Callidior/keras-applications">efficientnet keras pre-trained weights</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/qubvel/efficientnet">Implementation of EfficientNet model. Keras and TensorFlow Keras.</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20190912: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/c-json-serialize-using-json-net/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/c-json-serialize-using-json-net/" class="post-title-link" itemprop="url">serialize and deserialize json using json.net with csharp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-10 15:16:00" itemprop="dateCreated datePublished" datetime="2019-09-10T15:16:00+08:00">2019-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/csharp/" itemprop="url" rel="index"><span itemprop="name">csharp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><p>Json.NET</p>
<ul>
<li>JsonConvert.SerializeObject</li>
<li>JsonConvert.DeserializeObject</li>
</ul>
<h3 id="install"><a href="#install" class="headerlink" title="install"></a>install</h3><p>Use NuGet to download the package</p>
<pre><code>&quot;Project&quot; -&gt; &quot;Manage NuGet packages&quot; -&gt; &quot;Search for &quot;newtonsoft json&quot;. -&gt; click &quot;install&quot;.
</code></pre>
<h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>reference </p>
<pre><code>using Newtonsoft.Json;
</code></pre>
<h4 id="serialize-collections"><a href="#serialize-collections" class="headerlink" title="serialize collections"></a>serialize collections</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Product p1 = <span class="keyword">new</span> Product</span><br><span class="line">&#123;</span><br><span class="line">    Name = <span class="string">&quot;Product 1&quot;</span>,</span><br><span class="line">    Price = <span class="number">99.95</span>m,</span><br><span class="line">    ExpiryDate = <span class="keyword">new</span> DateTime(<span class="number">2000</span>, <span class="number">12</span>, <span class="number">29</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, DateTimeKind.Utc),</span><br><span class="line">&#125;;</span><br><span class="line">Product p2 = <span class="keyword">new</span> Product</span><br><span class="line">&#123;</span><br><span class="line">    Name = <span class="string">&quot;Product 2&quot;</span>,</span><br><span class="line">    Price = <span class="number">12.50</span>m,</span><br><span class="line">    ExpiryDate = <span class="keyword">new</span> DateTime(<span class="number">2009</span>, <span class="number">7</span>, <span class="number">31</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, DateTimeKind.Utc),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List&lt;Product&gt; products = <span class="keyword">new</span> List&lt;Product&gt;();</span><br><span class="line">products.Add(p1);</span><br><span class="line">products.Add(p2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> json = JsonConvert.SerializeObject(products, Formatting.Indented);</span><br><span class="line"><span class="comment">//[</span></span><br><span class="line"><span class="comment">//  &#123;</span></span><br><span class="line"><span class="comment">//    &quot;Name&quot;: &quot;Product 1&quot;,</span></span><br><span class="line"><span class="comment">//    &quot;ExpiryDate&quot;: &quot;2000-12-29T00:00:00Z&quot;,</span></span><br><span class="line"><span class="comment">//    &quot;Price&quot;: 99.95,</span></span><br><span class="line"><span class="comment">//    &quot;Sizes&quot;: null</span></span><br><span class="line"><span class="comment">//  &#125;,</span></span><br><span class="line"><span class="comment">//  &#123;</span></span><br><span class="line"><span class="comment">//    &quot;Name&quot;: &quot;Product 2&quot;,</span></span><br><span class="line"><span class="comment">//    &quot;ExpiryDate&quot;: &quot;2009-07-31T00:00:00Z&quot;,</span></span><br><span class="line"><span class="comment">//    &quot;Price&quot;: 12.50,</span></span><br><span class="line"><span class="comment">//    &quot;Sizes&quot;: null</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//]</span></span><br></pre></td></tr></table></figure>

<h4 id="deserialize-collections"><a href="#deserialize-collections" class="headerlink" title="deserialize collections"></a>deserialize collections</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">@&quot;[</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    &#x27;Name&#x27;: &#x27;Product 1&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;ExpiryDate&#x27;: &#x27;2000-12-29T00:00Z&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;Price&#x27;: 99.95,</span></span><br><span class="line"><span class="string">    &#x27;Sizes&#x27;: null</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    &#x27;Name&#x27;: &#x27;Product 2&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;ExpiryDate&#x27;: &#x27;2009-07-31T00:00Z&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;Price&#x27;: 12.50,</span></span><br><span class="line"><span class="string">    &#x27;Sizes&#x27;: null</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">]&quot;</span>;</span><br><span class="line"></span><br><span class="line">List&lt;Product&gt; products = JsonConvert.DeserializeObject&lt;List&lt;Product&gt;&gt;(json);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(products.Count);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">Product p1 = products[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">Console.WriteLine(p1.Name);</span><br><span class="line"><span class="comment">// Product 1</span></span><br></pre></td></tr></table></figure>

<h4 id="serialize-to-json-file"><a href="#serialize-to-json-file" class="headerlink" title="serialize to json file"></a>serialize to json file</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Movie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Year &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Movie movie = <span class="keyword">new</span> Movie</span><br><span class="line">&#123;</span><br><span class="line">    Name = <span class="string">&quot;Bad Boys&quot;</span>,</span><br><span class="line">    Year = <span class="number">1995</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// serialize JSON to a string and then write string to a file</span></span><br><span class="line">File.WriteAllText(<span class="string">@&quot;c:\movie.json&quot;</span>, JsonConvert.SerializeObject(movie));</span><br><span class="line"></span><br><span class="line"><span class="comment">// serialize JSON directly to a file</span></span><br><span class="line"><span class="keyword">using</span> (StreamWriter file = File.CreateText(<span class="string">@&quot;c:\movie.json&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    JsonSerializer serializer = <span class="keyword">new</span> JsonSerializer();</span><br><span class="line">    serializer.Serialize(file, movie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/18784697/how-to-import-jsonconvert-in-c-sharp-application">how-to-import-jsonconvert-in-c-sharp-application</a></li>
<li><a target="_blank" rel="noopener" href="https://www.newtonsoft.com/json/help/html/SerializingCollections.htm">SerializingCollections</a></li>
</ul>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20190910: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://kezunlin.me/blog/keras-data-augmentation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="kezunlin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kezunlin's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/keras-data-augmentation/" class="post-title-link" itemprop="url">keras data augmentation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-09-10 11:05:00" itemprop="dateCreated datePublished" datetime="2019-09-10T11:05:00+08:00">2019-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-10-14 13:39:28" itemprop="dateModified" datetime="2024-10-14T13:39:28+08:00">2024-10-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deep-learning/" itemprop="url" rel="index"><span itemprop="name">deep learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Guide"><a href="#Guide" class="headerlink" title="Guide"></a>Guide</h2><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import the necessary packages</span></span><br><span class="line"><span class="keyword">from</span> keras.preprocessing.image <span class="keyword">import</span> ImageDataGenerator</span><br><span class="line"><span class="keyword">from</span> keras.preprocessing.image <span class="keyword">import</span> img_to_array</span><br><span class="line"><span class="keyword">from</span> keras.preprocessing.image <span class="keyword">import</span> load_img</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> keras_util <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># construct the argument parse and parse the arguments</span></span><br><span class="line">ap = argparse.ArgumentParser()</span><br><span class="line">ap.add_argument(<span class="string">&quot;-i&quot;</span>, <span class="string">&quot;--image&quot;</span>, required=<span class="literal">True</span>,</span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;path to the input image&quot;</span>)</span><br><span class="line">ap.add_argument(<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;--output&quot;</span>, required=<span class="literal">True</span>,</span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;path to output directory to store augmentation examples&quot;</span>)</span><br><span class="line">ap.add_argument(<span class="string">&quot;-p&quot;</span>, <span class="string">&quot;--prefix&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;image&quot;</span>,</span><br><span class="line">    <span class="built_in">help</span>=<span class="string">&quot;output filename prefix&quot;</span>)</span><br><span class="line">args = <span class="built_in">vars</span>(ap.parse_args())</span><br><span class="line"></span><br><span class="line"><span class="comment"># load the input image, convert it to a NumPy array, and then</span></span><br><span class="line"><span class="comment"># reshape it to have an extra dimension</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[INFO] loading example image...&quot;</span>)</span><br><span class="line">target_size = <span class="literal">None</span> </span><br><span class="line"><span class="comment">#target_size=(224,224)</span></span><br><span class="line">image = load_img(args[<span class="string">&quot;image&quot;</span>], target_size=target_size)</span><br><span class="line">image = img_to_array(image)</span><br><span class="line">image = np.expand_dims(image, axis=<span class="number">0</span>) <span class="comment"># 1,h,w,c</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># construct the image generator for data augmentation then</span></span><br><span class="line"><span class="comment"># initialize the total number of images generated thus far</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># preprocessing_function: The function will run after the image is resized and augmented.</span></span><br><span class="line"><span class="comment"># The function should take one argument:</span></span><br><span class="line"><span class="comment">#    one image (Numpy tensor with rank 3),</span></span><br><span class="line"><span class="comment">#     and should output a Numpy tensor with the same shape.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for 1 image ---&gt;(424,640,3)---&gt;aug---(424,640,3)---&gt;preprocess_input---&gt;(424,640,3)</span></span><br><span class="line"><span class="comment"># for 1 image ---&gt;resize---&gt;(224,224,3)---&gt;aug---(224,224,3)---&gt;preprocess_input---&gt;(224,224,3)</span></span><br><span class="line">aug = ImageDataGenerator(preprocessing_function=resnet.preprocess_input,</span><br><span class="line">                         rotation_range=<span class="number">30</span>, </span><br><span class="line">                         width_shift_range=<span class="number">0.1</span>,</span><br><span class="line">                         height_shift_range=<span class="number">0.1</span>, </span><br><span class="line">                         shear_range=<span class="number">0.2</span>, </span><br><span class="line">                         zoom_range=<span class="number">0.2</span>,</span><br><span class="line">                         horizontal_flip=<span class="literal">True</span>,</span><br><span class="line">                         fill_mode=<span class="string">&quot;nearest&quot;</span>)</span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># construct the actual Python generator</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[INFO] generating images...&quot;</span>)</span><br><span class="line">imageGen = aug.flow(image, </span><br><span class="line">                    batch_size=<span class="number">1</span>, </span><br><span class="line">                    save_to_dir=args[<span class="string">&quot;output&quot;</span>],</span><br><span class="line">                    save_prefix=args[<span class="string">&quot;prefix&quot;</span>], </span><br><span class="line">                    save_format=<span class="string">&quot;png&quot;</span>)</span><br><span class="line"></span><br><span class="line">next_image = <span class="built_in">next</span>(imageGen)</span><br><span class="line"><span class="built_in">print</span>(next_image.shape)</span><br><span class="line"><span class="built_in">print</span>(next_image[<span class="number">0</span>, :<span class="number">5</span>,:<span class="number">5</span>,<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># loop over examples from our image data augmentation generator</span></span><br><span class="line"><span class="keyword">for</span> image <span class="keyword">in</span> imageGen:</span><br><span class="line">    <span class="comment"># increment our counter</span></span><br><span class="line">    total += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># if we have reached 10 examples, break from the loop</span></span><br><span class="line">    <span class="keyword">if</span> total == <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>output </p>
<p>  target_size &#x3D; None:    </p>
<blockquote>
<p>1 image —&gt;(424,640,3)—&gt;aug—&gt;(424,640,3)—&gt;preprocess_input—&gt;(424,640,3)</p>
</blockquote>
<p>  target_size &#x3D; (224,224): </p>
<blockquote>
<p>1 image —&gt;resize—&gt;(224,224,3)—&gt;aug—&gt;(224,224,3)—&gt;preprocess_input—&gt;(224,224,3)</p>
</blockquote>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><ul>
<li>20190910: created.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">kezunlin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">181</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">213</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">kezunlin</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
